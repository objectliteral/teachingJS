<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>teachingJS - The Language - </title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <style type="text/css">



a {
  color: #1122CC;
}

a:active {
  color: tomato;
}

a:focus {
  color: #660099;
  text-decoration: underline;
}

a:hover {
  
}

a:visited {
  color: #660099;
  text-decoration: underline;
}

blockquote {
  font-style: italic;
}

blockquote:before {
  content: "\201C";
  display: inline-block;
  padding-right: 0.4em;
}

body  { 
  color: #222222;
  margin: 0 auto;
  text-rendering: optimizeLegibility;
  width: 740px;
}

body,
input,
button  {
  -webkit-font-smoothing: antialiased;
  font-size: 14px;
}

code,
pre {
  background-color: #e6e6e6;
  font-family: Consolas, "DejaVu Sans Mono", "Source Code Pro", "Courier New", monospace;
  font-size: 1em;
}

em {
  font-style: italic;
}

h1 {
  font-size: 3em;
  margin: 3em 0 1.5em;
}

h2 {
  font-size: 2em;
  margin: 2em 0 1em;
}

h3 {
  font-size: 1.5em;
  margin: 1.5em 0 0.75em;
}

h4 {
  font-size: 1.27em;
  margin: 1.27em 0 0.635em;
}

h5 {
  font-size: 1em;
  margin: 1em 0 0.5em;
}

h6 {
  font-size: 0.83em;
  margin: 0.83em 0 0.415em;
}

html {
  font-family: "Open Sans", Arial, Verdana, sans-serif;
  font-size: 16px;
  line-height: 1.5;
}

p {
  line-height: 1.5;
  margin: 0 0 1em;
}

/*.indent p {
  margin: 0;
}*/
p  {
  word-break: break-word;
  -webkit-hyphens: auto;
  -moz-hyphens: auto;
  -ms-hyphens: auto;
  hyphens: auto;
}

p+p {
  /*margin-top: -1em;
  text-indent: 2em;*/
}

pre {
  line-height: 1.25;
  overflow-x: auto;
  padding: 0.5em 0.75em;
}

strong {
  font-style: bold;
}

#title {
  font-size: 5em;
  margin: 200px 0;
}
  </style>
</head>
<body>
<nav id="TOC">
<ul>
<li><a href="#preface">Preface</a><ul>
<li><a href="#how-i-approached-this-book">How I approached this book</a></li>
<li><a href="#how-time-approaches-this-book">How time approaches this book</a></li>
<li><a href="#how-you-should-approach-this-book">How you should approach this book</a></li>
<li><a href="#how-this-book-approaches-this-book">How this book approaches this book</a></li>
</ul></li>
<li><a href="#the-history-of-javascript">The History of JavaScript</a><ul>
<li><a href="#prehistoric-events-early-60s-to-late-80s">Prehistoric Events (early 60s to late 80s)</a><ul>
<li><a href="#the-great-grandfathers">The Great-Grandfathers</a></li>
<li><a href="#the-grandfathers">The Grandfathers</a></li>
</ul></li>
<li><a href="#the-beginning-and-the-war-1995-1999">The Beginning and the War (1995-1999)</a></li>
<li><a href="#the-metamorphosis-and-the-struggle-2000-2011">The Metamorphosis and the Struggle (2000-2011)</a><ul>
<li><a href="#ajax">Ajax</a></li>
<li><a href="#es4">ES4</a></li>
<li><a href="#strict-mode">Strict Mode</a></li>
</ul></li>
<li><a href="#harmony-2012-and-next">Harmony (2012 and Next)</a></li>
</ul></li>
<li><a href="#fundamentals">02 Fundamentals</a><ul>
<li><a href="#comments">Comments</a></li>
<li><a href="#a-javascript-program">A JavaScript program</a></li>
<li><a href="#stdout">stdout</a></li>
<li><a href="#hello-world">“Hello World”</a></li>
<li><a href="#browser-console">Browser console</a></li>
<li><a href="#browser-script">Browser script</a></li>
<li><a href="#node">Node</a></li>
<li><a href="#types-and-literals">Types and Literals</a><ul>
<li><a href="#undefined">Undefined</a></li>
<li><a href="#null">Null</a></li>
<li><a href="#boolean">Boolean</a></li>
<li><a href="#string">String</a></li>
<li><a href="#number">Number</a></li>
<li><a href="#object">Object</a></li>
<li><a href="#wrappers">Wrappers</a></li>
<li><a href="#arrays">Arrays</a></li>
</ul></li>
<li><a href="#statements">Statements</a><ul>
<li><a href="#declarations">Declarations</a></li>
<li><a href="#structuring-statements">Structuring statements</a></li>
<li><a href="#less-important-or-dangerous-statements">Less important or dangerous statements</a></li>
</ul></li>
<li><a href="#operators">Operators</a><ul>
<li><a href="#arithmetic-operators">Arithmetic operators</a></li>
<li><a href="#assignment-operators">Assignment operators</a></li>
<li><a href="#bitwise-operators">Bitwise Operators</a></li>
<li><a href="#comparison-operators">Comparison operators</a></li>
<li><a href="#logical-operators">Logical Operators</a></li>
<li><a href="#object-related-operators">Object-related operators</a></li>
<li><a href="#other-operators">Other operators</a></li>
<li><a href="#operator-precedence">Operator Precedence</a></li>
</ul></li>
<li><a href="#coercion">Coercion</a><ul>
<li><a href="#truthiness-and-falsiness">Truthiness and Falsiness</a></li>
<li><a href="#abstract-comparison-operator">Abstract comparison operator</a></li>
<li><a href="#number-coercion">Number coercion</a></li>
</ul></li>
<li><a href="#variables">Variables</a><ul>
<li><a href="#identifiers">Identifiers</a></li>
<li><a href="#variable-declaration">Variable Declaration</a></li>
<li><a href="#hoisting">Hoisting</a></li>
<li><a href="#variable-assignment">Variable Assignment</a></li>
<li><a href="#constant-declaration">Constant Declaration</a></li>
<li><a href="#declaration-with-let-es6">Declaration with <code>let</code> (ES6)</a></li>
<li><a href="#call-by-value-call-by-reference">Call-by-value / Call-by-reference</a></li>
</ul></li>
<li><a href="#bonus-automatic-semicolon-insert-asi">BONUS: Automatic Semicolon Insert (ASI)</a></li>
</ul></li>
<li><a href="#objects-part-i">03 Objects Part I</a><ul>
<li><a href="#composition">Composition</a></li>
<li><a href="#creation">Creation</a><ul>
<li><a href="#object-literals">Object literals</a></li>
<li><a href="#constructor">Constructor</a></li>
</ul></li>
<li><a href="#modification">Modification</a><ul>
<li><a href="#property-access">Property Access</a></li>
<li><a href="#updating-properties">Updating properties</a></li>
<li><a href="#deleting-properties">Deleting properties</a></li>
<li><a href="#inheritance">Inheritance</a></li>
</ul></li>
</ul></li>
<li><a href="#functions">04 Functions</a><ul>
<li><a href="#definition">Definition</a><ul>
<li><a href="#function-expression-function-literal">function expression (function literal)</a></li>
<li><a href="#function-constructor">Function constructor</a></li>
<li><a href="#function-declaration-function-statement">function declaration (function statement)</a></li>
<li><a href="#what-to-use">What to use?</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#immediately-invoked-function-expressions-iife">Immediately Invoked Function Expressions (IIFE)</a></li>
</ul></li>
<li><a href="#invocation">Invocation</a><ul>
<li><a href="#special-variables">Special variables</a></li>
<li><a href="#method-invocation">Method invocation</a></li>
<li><a href="#function-invocation">Function invocation</a></li>
<li><a href="#constructor-invocation">Constructor invocation</a></li>
<li><a href="#callapply-invocation">Call/Apply Invocation</a></li>
<li><a href="#binding-this">Binding <code>this</code></a></li>
</ul></li>
<li><a href="#scope">Scope</a><ul>
<li><a href="#function-scope">Function scope</a></li>
<li><a href="#global-scope">Global scope</a></li>
<li><a href="#modules">Modules</a></li>
<li><a href="#special-variables-1">Special variables</a></li>
</ul></li>
<li><a href="#arguments">Arguments</a><ul>
<li><a href="#arguments-1"><code>arguments</code></a></li>
<li><a href="#default-parameters">Default Parameters</a></li>
<li><a href="#bonus-rest-parameter-es6">BONUS: Rest Parameter (ES6)</a></li>
<li><a href="#bonus-destructuring">BONUS: Destructuring</a></li>
</ul></li>
<li><a href="#closure">Closure</a><ul>
<li><a href="#memoization">Memoization</a></li>
</ul></li>
<li><a href="#currying-and-partials">Currying and Partials</a><ul>
<li><a href="#partials">Partials</a></li>
<li><a href="#composition-1">Composition</a></li>
</ul></li>
<li><a href="#constructors">Constructors</a><ul>
<li><a href="#definition-1">Definition</a></li>
<li><a href="#using-constructors">Using Constructors</a></li>
<li><a href="#altering-the-prototype">Altering the prototype</a></li>
<li><a href="#using-closure">Using closure</a></li>
<li><a href="#private-variables">Private Variables</a></li>
</ul></li>
<li><a href="#bonus-y-combinator">BONUS: y-Combinator</a></li>
</ul></li>
</ul>
</nav>
<h1 id="title">
teachingJS
</h1>

<p>Copyright © 2013-2014 Peter Michael Steinberg</p>
<p>All rights reserved.</p>
<h2 id="preface">Preface</h2>
<p>This is a living document.</p>
<h3 id="how-i-approached-this-book">How I approached this book</h3>
<p>This book was created as a script for a workshop on JavaScript. I wrote it to gather my knowledge, to put it into words, to structure it, to illustrate it with examples. I assume the reader is familiar with programming in general and I sometimes compare JavaScript to Java, assuming this will be the most widely known language, but Java skills are not required. I sometimes also assume a basic knowledge of programming patterns or field specific terms. If you have never been programming before, this might not be a book for you.</p>
<p>I would love this book to be self-explainatory enough for it to be read without attending the related workshop, but as of now it isn’t. I want it to be a reference containing all there is to know, but it is not complete yet. I want it to be structured in a way that encapsulates topics in their own self-contained chapters or subchapters and I also want it to read better than a boring reference, but it is not there yet. All of these goals may never be met completely, because it is impossible to cover every edge case of the language and because there will always have to be a compromise between readabilty and correctness or completeness.</p>
<p>So as my work on this book progresses, my understanding of the language will change and even the language itself will change.</p>
<h3 id="how-time-approaches-this-book">How time approaches this book</h3>
<p>By the time of writing (early 2014), the most recent version of the language specification is ECMA262 Edition 5.1 (2011). Sometimes I point out changes over Edition 3 and I regularly include explanations on things that are going to be in Edition 6. But when there is no explicit information on the version of the language in which a certain feature exists or not, assume that I am talking about ES5.1. Most likely, you want to write code to be run inside a web browser. Fortunately, ES5 compatibility is more or less present in all current web browsers: Firefox 4+, Chrome 13+, Internet Explorer 10+, Safari 6+. ES6 support is not yet at a level at which you want to rely on ES6 features; give that some more years.</p>
<p>Every few months there is a new version of Firefox and Chrome and it will not take a long time until the notes on ES6 support regarding certain browsers in this book are outdated. In the meantime, the specification process for ES6 is still going on for who knows how long and things might change eventually. But this book is not considered “done”: As things change, so will this book (hopefully).</p>
<h3 id="how-you-should-approach-this-book">How you should approach this book</h3>
<p>Of course you can read this book however you like, but let me give you some information about how you get the most out of it. In trying to cover a topic in its completeness, I might go into some details you find unnecessary. Feel free to skip over anything you are not interested in or you what you think is confusing. You can also freely skip over any parts that I labeled more or less explicitly as being optional. You can always come back to those (advanced or just unimportant) paragraphs later and I tried to include a lot of cross-references to let you know where you can read up on a topic. This should motivate you to read just the chapters of the book you are interested in.</p>
<p>That does not mean, that the way in which the chapters and subchapters are ordered is irrelevant.</p>
<h3 id="how-this-book-approaches-this-book">How this book approaches this book</h3>
<p>After this introduction to the text, there will be a chapter on the history of JavaScript. It may influence your understanding of the language to know where it came from, what its influences are and how it developed over time. The history covers the past, the present and the future.</p>
<p>The introduction to the language itself will start with the fundamentals. First, there will be a short notice on how you can execute your own JavaScript code. Then the atoms and molecules of JavaScript are presented, the statements that compose a program, the operators that combine values to new values, the types of data you can manipulate in JavaScript and the weird mechanics of how JavaScript manipulates those data itself.</p>
<p>A short primer on objects follows, explaining what they are and how to work with them. But the real power of objects will be released later in a chapter about inheritance. Inheritance is the way in which objects are related to each other and is a really important thing to talk about.</p>
<p>But inheritance in JavaScript does not work without functions, so we will introduce them before talking about inheritance. Functions are a very important and a very beautiful thing about JavaScript and the chapter that covers them should teach you everything you need to know.</p>
<h1 id="the-history-of-javascript">The History of JavaScript</h1>
<p>The prevailing concepts in a programming language always fit into a certain context. Usually this is about the influences on the creators of a programming language, be it former experience with other languages, personal career background or company management directions. A multitude of factors determines design goals of a language and whether those goals are met or not. So in order to understand a language, to understand why it does certain things, why it follows certain paradigms it is necessary to put a language’s development into context. Especially with JavaScript there is a lot of discussion about what the language got right or wrong and what it wanted to be and what not and what it should be and what not. Maybe a bit of the language’s history can give you an idea on why it is what it is.</p>
<h2 id="prehistoric-events-early-60s-to-late-80s">Prehistoric Events (early 60s to late 80s)</h2>[...]
<h2 id="the-beginning-and-the-war-1995-1999">The Beginning and the War (1995-1999)</h2>
<p><em>Brendan Eich</em> (1961) started working for <em>Netscape</em> in April <em>1995</em>. He was hired to create a scripting language to be embedded into the 2.0 release of Netscape’s web browser, the Netscape Navigator. While Eich was originally asked to design this language based on Scheme, Netscape management quickly made it a high priority for the language to look like Java. It was aiming to be a simpler companion to Java which was the other candidate for being the programming language for the web at that time.</p>
<p>It is rumored that Eich specified the whole language that was originally called <em>Mocha</em> in about 10 days. The language’s syntax was similar to Java, but it incorporated Prototypal Inheritance like in Self and had first-class functions just as in Scheme. It was an interpreted language with a dynamic type system.</p>
<p>Mocha was quickly renamed to LiveScript and was included in Netscape Navigator 2.0 which came out September 1995. In December of the same year Netscape started a partnership with Sun with the goal that both companies would support one programming language for the web. This language was meant to be Java and probably Sun wanted Netscape to discontinue LiveScript in the long run but the companies agreed on a short term strategy: They began an effort to integrate JavaScript into Java and vice-versa with Java appealing to professional programmers and JavaScript being the lightweight little brother for quickly writing small scripts. Fortunately, things worked out very differently.</p>
<p>The most important long term result of the agreement between Netscape and Sun was that LiveScript was renamed to JavaScript. Though the two languages have little in common, the name JavaScript, now a trademark of Oracle, persists to this day and has caused confusion ever since. Despite the original intention, JavaScript is neither related to Java nor its little brother.</p>
<p>JavaScript gained traction right from the beginning and was quickly adopted by companies in order to write scripts for the web.</p>
<p>Microsoft was Netscape’s antagonist in what became the <em>browser war</em>. They also wanted to have a programming language inside their browser and because JavaScript was so promising, Microsoft reverse engineered JavaScript and included their own implementation of the language in Internet Explorer 3 in 1996. They called it JScript to avoid trademark issues and did a great job of resembling all of JavaScript’s quirks and implementing them in JScript as well.</p>
<p>Both Netscape and Microsoft also included support for JavaScript in their server environments, Netscape Enterprise Server 2.0 and IIS 3.0 respectively (both released in 1996).</p>
<p>In order to protect the language from the influence of Microsoft, Netscape tried to standardize JavaScript. After being rejected by W3C and ISO, the language found its home at the European Computer Manufacturers Association (today called <em>ECMA International</em>) in November 1996. JavaScript is since specified as ECMAScript under the standard ECMA-262. The first edition of the spec was published in 1997, the second one year later, the third in 1999.</p>
<p>The standardization process was problematic from the beginning. Netscape and Microsoft were both part of the commitee working on ECMAScript and they did not play well with each other. An important goal ever since, was to remove some of the original design flaws from the language, but Microsoft has always critically emphasized backward-compatibility and so a lot of bad stuff stayed in the language because of the fear of breaking existing code by removing language features. An important addition was made in Edition 2, with Arrays finding their way into the language. Sadly, this addition was not thought through and the arrays we have in JavaScript are still basically objects with some special properties. After the release of the third edition, work on the language slowed down and there was no new standard for the next ten years.</p>
<h2 id="the-metamorphosis-and-the-struggle-2000-2011">The Metamorphosis and the Struggle (2000-2011)</h2>
<h3 id="ajax">Ajax</h3>
<p>Besides the official standardization process, there was some other major process to change the course of the language’s history. Browsers implemented an API to make HTTP requests in JavaScript which was a feature that was underestimated at first. But in 2005 Interaction Designer Jesse James Garrett coined the term <em>“Asynchronous JavaScript and XML” (AJAX)</em>. His company, Adaptive Path, was experimenting on how to improve user experience when browsing a website, which also meant figuring out how to improve performance and responsive. Now Garrett came up with the idea, that instead of doing full page replacements, he could use the HTTP interface to only fetch the part of the page that needed to be replaced, when a new page was requested. Because things like navigations and side bars often stay the same across one website it is unnecessary to send those pieces of HTML over the wire everytime a user wants to visit a new page. The new technique resulted in smaller files and thus shorter loading times which accomplished the goal of streamlining user experience.</p>
<p>Not only made Adaptive Path their clients happy, but they also started a <em>Metamorphosis of JavaScript</em>. The language had gained traction over the years because it was the only programming language for the web and if you wanted to build some kind of interaction into your site you would have to use JavaScript or Flash. The later has a higher level of entry for programmers, but JavaScript was easy to use, forgiving and just enough to create animations like dropdown menus and that sort of things. But along with the AJAX revolution, developers started to realize that it is possible to build complex applications with what a lot of people thought was a toy language. Ajax also made it possible to load separate parts of an application one by one and only if needed so the user would not have to wait for some 200K of application code to be downloaded and initialized. This is what the asynchronous nature of JavaScript is all about: Dynamically reacting to user needs in order to load and run code only if needed. But the “<em>Asynchronous</em>” in Ajax further means that <em>HTTP calls are non-blocking</em>: When an HTTP request is sent to the server the execution of the JavaScript code or of the browser’s UI-rendering is put on hold. That is important because browsers implement a so-called <em>Event Loop</em> which is basically a task queue and because they are fundamentally single-threaded. A browser’s UI runs in the same thread as the JavaScript code and while that code runs, the browser view is not going to be refreshed. That is not a problem unless you are doing heavy computation or, say, wait for an HTTP-Request to return. If HTTP calls were synchronous they would freeze the browser window for one second or so until the response arrives or the request is eventually timed out.</p>
<h3 id="es4">ES4</h3>
<p>Back to the standardization process. While first proposals on the next language edition were made as of 1999, the commitee was torn on how big a change to implement in the new version. There were two factions, one of them promoting concepts with a lot of new syntax and semantics, while the other part of the committee favored small and careful adjustments over the introduction of drastic features. After a successful meeting in Oslo (here we are again in Norway, just where our journey started) in 2008 Brendan Eich declared a <em>“harmony”</em> among the commitee which became the working title of the next version of ECMAScript. It was decided to quickly agree on a moderate ES3.1, which carefully made minor adjustments to the language. ES4 should then be a greater step forward incorporating concepts like classes, block scope, constants and destructuring. As a diplomatic measure, ES3.1 was renamed to ES5 and ES4 was renamed to ES6; the problematic fourth edition was left out.</p>
<p>The struggle was overcome and ECMAScript 5th Edition was published in 2009. Some more changes accumulated and were addressed in another minor specification version as ES5.1 in 2011 making this the current version of the language.</p>
<h3 id="strict-mode">Strict Mode</h3>
<p>ES5 also includes what is called the <em>“Strict Mode”</em>. Strict mode defines a subset of JavaScript that disallows some of the potentially harmful features. If you don’t understand the following list, don’t be afraid: You probably will, after reading this book. Strict mode adds a handful of <code>SyntaxError</code>s that get thrown when you do weird stuff with <code>eval</code> and <code>arguments</code>. It forbids the use of <code>arguments.callee</code> and <code>arguments.caller</code>, octal number literals, <code>with</code> and it makes the default binding of <code>this</code> be <code>undefined</code> instead of the global object.</p>
<p>How to enable Strict Mode? You simply have to include a string at the first statement in your file.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="st">&#39;use strict&#39;</span>;

<span class="co">// ... your application code</span></code></pre>
<p>Strict Mode is supported by Firefox 4+, Chrome 13+, Internet Explorer 10+ and Safari 6+. These browsers will recognize the <code>'use strict';</code> statement and treat your code as strict code. Environments that do not support Strict Mode will simply ignore the <code>'use strict';</code> statement because it is a regular string expression with no effect. There is also a function form for Strict Mode: You include the <code>'use strict';</code> statement as the first statement in a function body and then this function will be executed in strict mode. It is generally not possible to toggle browser consoles into Strict Mode.</p>
<p>Future versions of the JavaScript language extend on ES5.1 Strict Mode so I advise you to use Strict Mode whenever possible.</p>
<h2 id="harmony-2012-and-next">Harmony (2012 and Next)</h2>[...]
<h1 id="fundamentals">02 Fundamentals</h1>
<p>In order to learn how to write JavaScript programs we will introduce the building blocks of the language one-by-one. We will not write useful code right away but start with covering the fundamental aspects of the language that set the basis for everything you will learn later on and provide you with enough knowledge to feel like you can estimate the extent of the langauge. I chose this approach over a more practical one so that we can cover all the topics in a complete and self-contained fashion. Working a lot with practical examples is great, but it can easily lead to an unstructured text where pieces of information regarding a specific topic are scattered all over the place rather than being fully explained in their own chapter.</p>
<p>As a consequence of this approach, the following chapter might seem daunting at times, but it contains a lot of useful information. It coveres: - JavaScript’s types, - the statements you can use to build your program, - all the operators that are in the language to compute new values from existing ones, - information about how the language converts values of one type into another type and - it shows you how variables are declared.</p>
<p>Example code in this chapter is rather short and often very generic. Its main purpose here is to illustrate syntax of new language elements.</p>
<h3 id="comments">Comments</h3>
<p>Because you will encouter them in example code, I want to quickly introduce comments. Comments inside JavaScript code are written in C-syntax meaning that block comments start with <code>/*</code> and end with <code>*/</code> and line comments start with <code>//</code> and end with the end of the line.</p>
<p>In the examples in the following chapters there are a lot of expressions that do not really do anything but that evaluate to a value. If I mean to tell you, what this value is, I include it in a comment after the expression. Example:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="dv">1</span> + <span class="dv">5</span>; <span class="co">// 6</span></code></pre>
<h3 id="a-javascript-program">A JavaScript program</h3>
<p>When you read an introductory book about a programming language it often tells you early on how you can execute a program and what a program in that language consists of anyway. What I don’t like about the idea is that it might be difficult for a newcomer to distinguish between a language and the environment that it runs in. But I feel like it is more important to give you the opportunity to try out some code and get your hands dirty, so let’s get to it.</p>
<p>JavaScript is an interpreted language. That means that JavaScript source code is not compiled to executable code which can be run directly by the operating system. Nor does JavaScript source code compile to bytecode that runs in a VM or something like that. Well, of course, JavaScript code <em>is</em> compiled to executable code, but this is done while the code is being executed. As a consequence, JavaScript needs to have a runtime environment where an interpreter compiles the code (using enormously clever techniques) and runs it right away. The most common runtime environment - the one everybody has installed on their computer - is a web browser. JavaScript was meant to be a programming language for the web and shortly after its release, supporting JavaScript execution became obligatory for browser vendors to implement. Whether you use Google Chrome, Mozilla Firefox, Opera, Apple Safari or even Microsoft Internet Explorer - you are using a JavaScript runtime environment every day. Those browsers differ in their implementation of JavaScript in some features of the language they do or do not support, in the speed at which they compile and run JavaScript code and in weird quirks that sometimes make it really hard to write code that runs in all browsers. But you can also run JavaScript on the console using implementations like NodeJS or PhantomJS. NodeJS is the most important “server-side” JavaScript environment and while also coming with a console REPL, it allows you to run any JavaScript code from a file.</p>
<h3 id="stdout">stdout</h3>
<p>One particular function that you should know is the default way in which we output text to the console (independent of whether this console is inside a web browser or not) because the examples make heavy use of that. <code>console.log</code> is not part of the JavaScript language but is by convention implemented in nearly all modern JavaScript environments. So for all of our tests and examples we will use <code>console.log</code> just like you would use <code>System.out.println</code> in Java.</p>
<h3 id="hello-world">“Hello World”</h3>
<p>JavaScript does not rely on any formal construct that you need to include in your program in order to run it; like there is no <code>main</code> function or whatsoever. You simply place your code where an interpreter can find it and off you go. In order to write a simple “Hello World”-program we don’t need to do anything but to log something to the console like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">console</span>.<span class="fu">log</span>(<span class="st">&#39;Hello Word!&#39;</span>);</code></pre>
<p>Now where do you need to enter this code in order to run it? Again, I don’t want to go into any details about JavaScript environments right now, but I believe it helps your understanding of the language plus it enables you to test out your own code.</p>
<h3 id="browser-console">Browser console</h3>
<p>There are basically two ways you can execute JavaScript code in your browser. The first one is by entering it into the browser console. You can open up the developer tools of your browser by pressing <code>F12</code> in Chrome and Internet Explorer and by pressing <code>Ctrl</code>+<code>Shift</code>+<code>k</code> in Firefox. In the panel that will show up, there is generally a “Console” tab. This tab includes a textinput in which you can enter your JavaScript code and execute it by pressing <code>Return</code>. If you have never done this before: Try it! Works? Congratulations to your very first bit of JavaScript code!</p>
<h3 id="browser-script">Browser script</h3>
<p>Browsers render webpages from HTML-formatted text. An HTML document can contain a <code>&lt;script&gt;</code> tag which tells the browser to execute everything inside that tag as JavaScript code. You can write a simple HTML document containing a <code>script</code> element and place your JavaScript code in there. You can then open the document with your browser that will execute the code immediately. Make sure to have the console opened up in order to see the output your are making.</p>
<pre class="sourceCode HTML"><code class="sourceCode html"><span class="er">&lt;</span>!doctype html&gt;
<span class="kw">&lt;html&gt;</span>
    <span class="kw">&lt;body&gt;</span>
        <span class="kw">&lt;script&gt;</span>
<span class="er">            console.log(&#39;Hello World!&#39;);</span>
        <span class="kw">&lt;/script&gt;</span>
    <span class="kw">&lt;/body&gt;</span>
<span class="kw">&lt;/html&gt;</span></code></pre>
<h3 id="node">Node</h3>
<p>As said before, NodeJS comes with a REPL for you OS console. If you don’t like to run examples in your browser, download NodeJS from <a href="http://www.nodejs.org">their website</a>, install it, open up your OS’ command prompt and type in <code>node</code>. That will enter the node shell where you can enter JavaScript code and execute it with <code>Return</code>.</p>
<p>You can also put your code in a file, say <code>hello.js</code>, and execute it by entering <code>node hello.js</code> in your command prompt.</p>
<hr />
<p>Now you should be able to execute your own JavaScript code or at least copy and paste the examples from this book into your execution environment of choice and confirm that the example code does what I say it does. Without further ado let’s start looking at the fundamental concepts and parts of the language.</p>
<h2 id="types-and-literals">Types and Literals</h2>
<p>In many languages like C and Java the concept of types describes categories of values such as numbers and text. Types also apply to variables that are being determined to only contain values of a certain type or kind. JavaScript as well knows the concept of types, but is rather leisure about it. For instance it does not make any restrictions to variables being limited to only contain values of specific types which is why JavaScript is often mistakenly referred to as a type-agnostic language, which it is not.</p>
<p>Since the JavaScript interpreter does a lot of work for you when it comes to types, it is not surprising that it does not always get it right. Talking about types in JavaScript always means talking about the language’s quirks.</p>
<p>The following is a brief overview of the types in JavaScript</p>
<h3 id="undefined">Undefined</h3>
<p>The type undefined has just one value, which is also called <code>undefined</code>. It is the default value of all variables that have been declared but have not (yet) been assigned a value. You can also use the <code>undefined</code> value by simply using it literally.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> a;
<span class="ot">console</span>.<span class="fu">log</span>(a); <span class="co">// undefined</span>
<span class="kw">var</span> b = <span class="dv">0</span>;
b = <span class="kw">undefined</span>;
<span class="ot">console</span>.<span class="fu">log</span>(b); <span class="co">// undefined</span></code></pre>
<h3 id="null">Null</h3>
<p>Just like Undefined the type of Null only has one value: <code>null</code>. It can be used to indicate, that a variable is intentionally set to something that is not really anything. Also just like <code>undefined</code>, <code>null</code> can be used literally.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> a = <span class="kw">null</span>;
<span class="ot">console</span>.<span class="fu">log</span>(a); <span class="co">// null</span></code></pre>
<h3 id="boolean">Boolean</h3>
<p>The type Boolean represents two values of Boolean logic: <code>true</code> and <code>false</code>. These values can be used literally.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> right = <span class="kw">true</span>;
<span class="kw">var</span> wrong = <span class="kw">false</span>;</code></pre>
<h3 id="string">String</h3>
<p>A value of the String type is a sequence of zero or more Unicode characters. There is no character type in JavaScript, single characters are simply Strings with a length of 1.</p>
<p>In order to use string in your code, you can also rely on a literal. Conveniently the string literal is a pair of <code>&quot;</code> double quotes or <code>'</code> single quotes. These two mean absolutely the same: They create a string value with the contents of the text, enclosed in the quotation marks.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> hi = <span class="st">&quot;Hello&quot;</span>;
<span class="kw">var</span> earth = <span class="st">&#39;World&#39;</span>;
<span class="ot">console</span>.<span class="fu">log</span>(hi + earth); <span class="co">// &#39;Hello World&#39;</span></code></pre>
<p>But how can you represent a string, containing a double or single quotation mark? This is done by using the escape character <code>\</code> (backslash). Some characters are treated differently, when inside a string and preceded with the escape character.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">escape sequence</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>\&quot;</code></td>
<td style="text-align: left;">double quote character (<code>&quot;</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>\'</code></td>
<td style="text-align: left;">single quote character (<code>'</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>\n</code></td>
<td style="text-align: left;">line break</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>\t</code></td>
<td style="text-align: left;">tab</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>\r</code></td>
<td style="text-align: left;">carriage return</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>\b</code></td>
<td style="text-align: left;">backspace</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>\f</code></td>
<td style="text-align: left;">formfeed</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>\v</code></td>
<td style="text-align: left;">vertical tab</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>\\</code></td>
<td style="text-align: left;">backslash character (<code>\</code>)</td>
</tr>
</tbody>
</table>
<h3 id="number">Number</h3>
<p>In contrast to many other languages, JavaScript only has one type for numbers: Number. This type contains all 64bit values as specified in the IEEE 754 standard, which covers the same precision as “Double” values in other languages. One special value, defined by the IEEE specification is <code>NaN</code> which stands for “Not a Number” and is meant to be placed everywhere, where a sane computation would not have any result, like when the conversion of a value to a number fails, or where the result is not a real number, like when calculating the sqare root of -1. The result of a computation involving <code>NaN</code> is always <code>NaN</code>. Two additional special values for the Number type in JavaScript are <code>Infinity</code> and <code>-Infinity</code>, representing an over- or underflow of the set of numbers that is covered by 64bit values.</p>
<p>NOTICE: When dividing a number by zero, the result will be <code>Infinity</code> or <code>-Inifinity</code> based on the number’s sign. <code>NaN</code> is the result of dividing zero by zero.</p>
<p>NOTICE: <code>undefined</code> behaves as <code>NaN</code> when used in computation (numeric context), <code>null</code> behaves as <code>0</code>.</p>
<p>NOTICE: The implementation of the IEEE standard has difficulties with operations on non-integer numbers. For example in JavaScript <code>0.1 + 0.2</code> is not <code>0.3</code> but <code>0.30000000000000004</code> (just as <code>0.9 - 0.6</code> is <code>0.30000000000000004</code> or <code>0.9 - 0.8</code> is equal to <code>0.09999999999999998</code>). When doing arithmetic operations in JavaScript you should always be aware of this problem!</p>
<h3 id="object">Object</h3>
<p>All the types above are called primitive types. Every value in JavaScript, that is not of a primitive type, is an object. JavaScript objects are quite different from objects in other languages and because of their fundamental value for JavaScript there is a whole chapter on objects.</p>
<p>Objects are basically just key-value pairs. That’s it. Keys have to be strings but the values of object properties can be any value like strings, objects or functions. The flexibility of objects makes them extremely powerful and allows you to use them for a variety of tasks.</p>
<p>For the code examples in this chapter, all you need to know is that you can access an object’s properties by using qualified identifiers in dot-notation like so:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">myObject</span>.<span class="fu">myProperty</span>;</code></pre>
<p>Just like the primitive types, objects have a literal. You can define a single object using a pair of curly braces <code>{ }</code>, that can contain zero or more comma-seperated key-value pairs.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> lastJedi = {
    <span class="st">&#39;name&#39;</span> : <span class="st">&#39;Luke Skywalker&#39;</span>,
    <span class="st">&#39;yob&#39;</span> : -<span class="dv">19</span>,
    <span class="st">&#39;homeplanet&#39;</span> : {
        <span class="st">&#39;name&#39;</span> : <span class="st">&#39;Tatooine&#39;</span>,
        <span class="st">&#39;rotPeriod&#39;</span> : <span class="dv">23</span>
    }
};</code></pre>
<p>Above you can see an object that contains three properties of different types.</p>
<h3 id="wrappers">Wrappers</h3>
<p>There are so called wrapper objects for some of the primitive types. They provide methods for booleans, strings and numbers. Their primitive value can be requested by the <code>valueOf</code> method. The most useful set of methods is provided by the <code>String</code> wrapper.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> b = <span class="kw">new</span> <span class="fu">Boolean</span>(<span class="kw">true</span>);
<span class="ot">b</span>.<span class="fu">valueOf</span>(); <span class="co">// true</span>

<span class="kw">var</span> n = <span class="kw">new</span> <span class="fu">Number</span>(<span class="dv">42</span>);
<span class="ot">n</span>.<span class="fu">toExponential</span>(); <span class="co">// &quot;4.2e+1&quot;</span></code></pre>
<p>You do not really need to create wrapper objects in order to access their methods. Wrapper methods can be used on any variable, containing a primitive value, or any expression, that evaluates to a primitive value. JavaScript will automatically create a wrapper object, invoke the method on it, return the method’s return value and discard the object.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="st">&quot;hello world&quot;</span>.<span class="fu">toUpperCase</span>(); <span class="co">// &quot;HELLO WORLD&quot;</span>
(<span class="dv">1337</span>).<span class="fu">toExponential</span>(); <span class="co">// 1.337e+3</span></code></pre>
<p>The builtin methods will be discussed in <a href="#XX.XX">XX.XX</a>.</p>
<p>Generally, there is no need to use the wrapper functions. <code>Number</code> and <code>Boolean</code> do not provide useful methods and the methods of <code>String</code> can directly be used on string values, which will be temporarily converted to an object by the interpreter. There are also constructor functions for objects and arrays, but instead of writing <code>new Object()</code> or <code>new Array()</code> you should be using the literals <code>{}</code> and <code>[]</code> respectively.</p>
<h3 id="arrays">Arrays</h3>
<p>There is no array type in JavaScript. Arrays are special objects that have numeric indeces, a magic <code>length</code> property and their own literal. You can create an array using a pair of square brackets <code>[ ]</code>, containing zero or more comma-seperated values.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> planets = [ <span class="st">&#39;Dantooine&#39;</span>, <span class="st">&#39;Alderaan&#39;</span>, <span class="st">&#39;Coruscant&#39;</span> ];</code></pre>
<p>Arrays will be discussed in more detail in <a href="#06.01.00">chapter 6</a>.</p>
<h2 id="statements">Statements</h2>
<p>Let us look at the building blocks of a JavaScript (or actually any) program: Statements. A JavaScript program consists of zero or more statements. A statement usually involves using a keyword and some special syntax.</p>
<p>This sub-chapter will introduce all the statements in JavaScript and explain them briefly. Some of them are more important than others, some are dangerous and some are weird. Some of them should not be used at all. Finally, there are some of them, which are being introduced to the language in its next version (ES6, more on that in <a href="#XX.XX">XX.XX</a>).</p>
<p>Following is a description of all statements in JavaScript.</p>
<h3 id="declarations">Declarations</h3>
<p>In most programming languages you assign values to names. These names are often variables that can contain different values over time. In JavaScript there is one important way to define such a variable (and another two ways that will become available in the future).</p>
<h4 id="var"><code>var</code></h4>
<p>A <code>var</code> statement declares a variable and optionally assigns it a value. Variables are function scoped (more on that in 04.03).</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> x = <span class="dv">3</span>;
<span class="ot">console</span>.<span class="fu">log</span>(x); <span class="co">// 3</span>
x = <span class="st">&#39;a string value&#39;</span>;
<span class="ot">console</span>.<span class="fu">log</span>(x); <span class="co">// &#39;a string value&#39;</span></code></pre>
<h4 id="const-es6"><code>const</code> (ES6)</h4>
<p>A <code>const</code> statement declares a readonly variable and assigns it a value.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">const</span> pi = <span class="fl">3.141592653589793</span>;
<span class="ot">console</span>.<span class="fu">log</span>(pi); <span class="co">// 3.141592653589793</span>
pi = <span class="dv">3</span>;
<span class="ot">console</span>.<span class="fu">log</span>(pi); <span class="co">// 3.141592653589793</span></code></pre>
<p>Constants are currently not part of the official JavaScript language specification, but they are very likely to be in the next version of the language and they are already supported in the most important environments.</p>
<h4 id="let-es6">let (ES6)</h4>
<p>Similar to <code>const</code> and <code>var</code>, <code>let</code> declares a variable with optional immediate assignment of a value. The difference being, that <code>let</code> is block scoped, while <code>var</code> is function scoped. More on scope in <a href="#04.03.00">04.03</a>.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> answer = <span class="dv">42</span>;</code></pre>
<p>There are some special flavored syntaxes for <code>let</code> which will be discussed in subchapter 02.05.</p>
<h3 id="structuring-statements">Structuring statements</h3>
<p>While it is possible to write code that consists of a linear series of statements that are executed one-by-one, you usually want to structure your program and use conditional or repeated execution of certain parts. The following statements help you with that. These statements are mostly straightforward and behave just like you would expect them to do (which is kind of a rare thing in JavaScript).</p>
<h4 id="block">block</h4>
<p>Just pro forma: A Block is a list of zero or more statements, surrounded by curly braces. Statements inside a block are executed in order unless this execution order is altered by a statement.</p>
<p>Example:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">{
    <span class="kw">var</span> foo = <span class="st">&#39;bar&#39;</span>;
    <span class="ot">console</span>.<span class="fu">log</span>(<span class="st">&#39;hi&#39;</span>);
}</code></pre>
<p>Some of the following definitions will mention a statement, that conditionally or repeatedly executes; it is always possible that this statement is a block including more statements.</p>
<h4 id="if-else">if … else</h4>
<p>An <code>if</code> statement describes a condition that is an expression getting evaluated to either true or false. If it is <code>true</code> the statement following the condition is executed. If it is <code>false</code> an optional second statement is executed that is preceded by the <code>else</code> keyword. It is also possible to use <code>else if</code> to chain more alternative conditions together.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">if</span> (a === b) {
    <span class="co">// do something</span>
} <span class="kw">else</span> <span class="kw">if</span> (a === c) {
    <span class="co">// do something else</span>
} <span class="kw">else</span> {
    <span class="co">// or at least do this</span>
}</code></pre>
<h4 id="loops">Loops</h4>
<p>There are several ways to iterate over a statement and execute it repeatedly.</p>
<h5 id="while">while</h5>
<p><code>while</code> executes a given statement as long as a condition evaluates to <code>true</code>. The condition is checked, each time before the statement is run, and as soon as it is <code>false</code>, the next statement after the <code>while</code>-block will be executed.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">while</span> (i &lt; n) {
    i += <span class="dv">1</span>;
}
<span class="co">// now, i is equal to n</span></code></pre>
<h5 id="for">for</h5>
<p>A for statement consists of a statement, preceded by a group of three expressions. The first of these expressions is evaluated, when the <code>for</code> statement is first encoutered, and is usually used for inizializing a counter variable. If the second expression evaluates to <code>true</code>, the statement is executed and the expression is checked again, until it finally evaluates to <code>false</code> and the next statement after the <code>for</code> statement is executed. The third expression is evaluated each time after the statement was executed and usually does something like incrementing the counter variable.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; n; i += <span class="dv">1</span>) {
    <span class="ot">console</span>.<span class="fu">log</span>(i);
}</code></pre>
<p>All the three expressions in the head of the loop are optional. If the middle one is missing, it is assumed to be always true (which is almost never what you want). The two semicolons are required, even if one of the expressions is left out.</p>
<p>If you are used to writing <code>for</code> loops in other languages, you might write something like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; n1; i += <span class="dv">1</span>) {
    <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; n2; i += <span class="dv">1</span>) {
        <span class="co">// do something</span>
    }
}</code></pre>
<p>This will not work like you would expect it to do. The two <code>i</code> variables are the same because in JavaScript variables are function scoped and not block scoped. We will cover scoping in a bit more detail in <a href="#04.05.00">chapter 04.05</a>. The above code would create and infinite loop if <code>n2</code> is greater than <code>n1</code>.</p>
<h5 id="for-in">for … in</h5>
<p>A for … in statement iterates over all of an object’s enumerable properties and consecutively assigns the current property name to a variable. After the <code>for</code> keyword there are parentheses enclosing a variable to that the property names will be assigned to, the <code>in</code> keyword and the object to iterator over, followed by a statement to be executed on each iteration.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> person = { <span class="dt">name </span>: <span class="st">&#39;Bob&#39;</span>, <span class="dt">age </span>: <span class="dv">30</span> };
<span class="kw">for</span> (<span class="kw">var</span> i <span class="kw">in</span> person) {
    <span class="ot">console</span>.<span class="fu">log</span>(i + <span class="st">&#39;: &#39;</span> + person[i]);
}
<span class="co">// &#39;name: Bob&#39;</span>
<span class="co">// &#39;age: 30&#39;</span></code></pre>
<p>First thing to mention is, that <code>for ... in</code> iterates over all enumerable properties of an object, including inherited ones. That is often not what you want, so you always use the <code>has.OwnProperty</code> method to filter out all of the inherited properties and only execute your code for the direct members of the object you iterate over:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">for</span> (<span class="kw">var</span> i <span class="kw">in</span> obj) {
    <span class="kw">if</span> (<span class="ot">obj</span>.<span class="fu">hasOwnProperty</span>(i)) {
        <span class="co">// only run your code here</span>
    }
}</code></pre>
<p>NOTICE: When using <code>for ... in</code> to iterate over an array, the order, in which the properties are visited, is not guaranteed. You should not use <code>for ... in</code> with arrays, when order is important! Use a <code>for</code> loop with a numeric counter instead.</p>
<p>NOTICE: When altering the object that is being iterated over from inside the loop, you will experience inconsistent behavior. Do not alter any of the objects properties except the currently visited one!</p>
<h5 id="for-of-es6">for … of (ES6)</h5>
<p>The <code>for ... of</code> statement is similar the <code>for ... in</code> with the major differences being, that the loop variable is not assigned the property name of the currently visited property but its value, and that the iteration happens in the correct order for numeric indeces. But since this feature currently only exists in Firefox, you can not yet use it, although it might be part of the language some day.</p>
<h4 id="function-related-statements">function related statements</h4>
<h5 id="function">function</h5>
<p>A function definition consists of the <code>function</code> keyword, a valid identifier as a name, a comma-seperated, parentheses-enclosed list of identifiers being function parameters and a block containing the function body with zero or more statements in it. Function definitions can be written as expressions or statements. A function statement declares a variable in the current scope and assigns it a newly created function object that has the specified parameter list and function body. More on function declaration in <a href="#04.01.00">04.01</a>.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> add = <span class="kw">function</span> (x, y) {
    <span class="kw">return</span> x + y;
};</code></pre>
<h5 id="return">return</h5>
<p>Every function returns a value, when its execution is terminated. To specify a return value or terminate a function early, you can use the return statement.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> add = <span class="kw">function</span> (x, y) {
    <span class="kw">return</span> x + y;
};</code></pre>
<p>NOTICE: There must not be a line break between the <code>return</code> keyword and the expression of the return value, because Automatic Semicolon Insertion will step in an the return value will be <code>undefined</code>;</p>
<h3 id="less-important-or-dangerous-statements">Less important or dangerous statements</h3>
<h4 id="loops-and-loop-related-statements">Loops and loop related statements</h4>
<h5 id="break">break</h5>
<p>The <code>break</code> statement interrupts the execution of the current loop, switch statement or any labeled statement and resumes program execution at the next statement of the one that was terminated.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">loop0:
<span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; n; i += <span class="dv">1</span>) {
    <span class="kw">while</span> (<span class="fu">f</span>(i)) {}
        <span class="kw">if</span> (i === <span class="fu">f</span>(n)) {
            <span class="kw">break</span> loop0;
        }
    }
    <span class="kw">if</span> (<span class="fu">foo</span>(n)) { <span class="kw">break</span>; }
}</code></pre>
<p>Since breaking in loops makes the execution flow harder to understand, it is best practice, to avoid the <code>break</code> statement.</p>
<h5 id="continue">continue</h5>
<p>A continue statement in a loop, terminates the execution of the current loop iteration and starts with the next iteration.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; n; i += <span class="dv">1</span>) {
    <span class="kw">if</span> (<span class="fu">f</span>(i)) {
        <span class="kw">continue</span>;
    }
}</code></pre>
<p>Continue statements can also include a label just like <code>break</code> statements.</p>
<h5 id="do-while">do … while</h5>
<p>A do while statement specifies a statement, that is executed at least once and then as long as a given condition is fulfilled. The condition is an expression that is evaluated to one of the values <code>true</code> or <code>false</code>.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">do</span> {
    <span class="ot">console</span>.<span class="fu">log</span>(i);
    i += <span class="dv">1</span>;
} <span class="kw">while</span> (i &lt; n);</code></pre>
<h5 id="for-each-of">for each … of</h5>
<p>If you ever see someone mention a <code>for each ... of</code> statement, just ignore him. This statement was meant to perform iteration over object properties, but it has been removed from the language and most implementations.</p>
<h5 id="label">label</h5>
<p>A label can be used to name loops and blocks. These names are used by break, continue and switch statements, but have no other meaning. See <a href="#02.01.01">02.01.01</a> and <a href="#02.01.02">02.01.02</a> for examples. Blocks can also have labels:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">test : {
    <span class="ot">console</span>.<span class="fu">log</span>(<span class="st">&#39;hi&#39;</span>);
}</code></pre>
<h4 id="debugger">debugger</h4>
<p>The <code>debugger</code> statement has no defined behavior but can be used by implementors to provide some kind of debugging means.</p>
<h4 id="switch">switch</h4>
<p>Switch evaluates an expression and matches it against labels. To each label there is an associated statement and when the expression matches a label, the associated statement is executed. If no match is found, an optional <code>default</code> clause is executed. You can use <code>break</code> in a statement, to step out of the clause’s execution and continue after the <code>switch</code> statement. After a labeled statement is executed, instead of the switch statement’s execution being terminated, the following labeled statement inside the switch statement (if there is another labeled statement) is executed - this is called “cases falling through”. You shoud absolutely prevent that from happening and so, while using <code>break</code> in clause is syntactically optional, it is semantically mandatory.</p>
<p>Because of the questionable behavior of <code>switch</code>, it is best to avoid using it.</p>
<h4 id="throw">throw</h4>
<p>JavaScript has exception handling and <code>throw</code> is used to throw one. This will result in the immediate termination of the current execution context (function) giving control to the previous context until a <code>try ... catch</code> clause is found. Execution is then continued in the block following the <code>catch</code> statement and the value that was thrown is bound to the <code>catch</code> block’s parameter. Any value can be thrown.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">throw</span> <span class="st">&quot;Houston, we got a problem.&quot;</span>;</code></pre>
<h4 id="try-catch">try … catch</h4>
<p>If you want to catch an exception, you have to wrap the statements that might throw it in a <code>try</code> block. Following has to be a <code>catch</code> or a <code>finally</code>. The <code>catch</code> clause is executed when an exception is thrown, the <code>finally</code> clause is always executed whether the try was successful or whether an exception was thrown.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">try</span> {
    <span class="fu">dangerousFunction</span>();
} <span class="kw">catch</span> (errorvariable) {
    <span class="fu">dealWithIt</span>(errorvariable);
} <span class="kw">finally</span> {
    <span class="fu">cleanUp</span>();
}</code></pre>
<p>While JavaScript generally uses function scope for its variables, the variable that gets caught by <code>catch</code> (<code>errorvariable</code> in the example above) is block scoped to the <code>catch</code> block.</p>
<h4 id="with">with</h4>
<p><code>with</code> executes a statement in the scope of a given object. So any unqualified variable names inside the statement will be looked up in the object (following the prototype chain, more on that in <a href="#XX.XX">XX.XX</a>).</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">with</span> (obj) {
    a = b;
}</code></pre>
<p>This would be the same as:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">if</span> (<span class="ot">obj</span>.<span class="fu">a</span> === <span class="kw">undefined</span>) {
    <span class="kw">if</span> (<span class="ot">obj</span>.<span class="fu">b</span> === <span class="kw">undefined</span>) {
        a = b;
    } <span class="kw">else</span> {
        a = <span class="ot">obj</span>.<span class="fu">b</span>;
    }
} <span class="kw">else</span> {
    <span class="kw">if</span> (<span class="ot">obj</span>.<span class="fu">b</span> === <span class="kw">undefined</span>) {
        <span class="ot">obj</span>.<span class="fu">a</span> = b;
    } <span class="kw">else</span> {
        <span class="ot">obj</span>.<span class="fu">a</span> = <span class="ot">obj</span>.<span class="fu">b</span>;
    }
}</code></pre>
<p>This code is far too hard to understand and very hard to predict. For the sake of your code’s clarity, do not use <code>with</code>.</p>
<h4 id="yield-es6">yield (ES6)</h4>[...]
<h2 id="operators">Operators</h2>
<p>Operators are special keywords or symbols that execute operations on one or more operands. Because some of the operators in JavaScript show weird behavior in some cases, we will cover some of those here although you may not encounter all of the edge cases when writing your first programs. You should be aware of the caveats with some of the following operators!</p>
<h3 id="arithmetic-operators">Arithmetic operators</h3>
<h4 id="section">+</h4>
<p>The Plus operator behaves differently based on what types its operands are.</p>
<p>If both operands are of type <code>Number</code>, <code>+</code> will create a new number value, which will be equal to the sum of the operands. If one or both of the operands are boolean values, <code>true</code> gets converted to <code>1</code>, <code>false</code> gets converted to <code>0</code> and a new number value is created, equaling the sum of the operands.</p>
<p>NOTICE: Unfortunately the IEEE Standard, used for JavaScript’s Number type, has difficulties with some operations on decimal digits. That leads to unreliable behavior like <code>0.1 + 0.2</code> being equal to <code>0.30000000000000004</code>. You should take special care, when doing sensitive calculations with non-integer numbers.</p>
<p>If one or both of the operands are of type String or Object, <code>+</code> will treat both as strings and concatenate them to a new one. If both operands are strings, a new string is created, that is the concatenation of the operands.</p>
<pre><code>&#39;4&#39; + &#39;2&#39; + 2 // &#39;422&#39;
4 + 2 + &#39;2&#39; // &#39;62&#39;</code></pre>
<p><code>null</code> and <code>undefined</code> each are converted to a string, when the other operand is a string or an object, and are converted to a number, in every other case.</p>
<p>The <code>+</code> operator can also be used as a unary operator with one string operand, which it will convert to a number.</p>
<pre><code>+&#39;42&#39; // 42</code></pre>
<h4 id="section-1">-</h4>
<p>The Minus operator always treats its operands as numbers and produces a new value that is the difference of the operands.</p>
<p>The minus symbol <code>-</code> can also be used as a unary negation operator with numbers. It creates a new value that has the same absolute value as the operand but the opposite sign.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> a = <span class="dv">4</span>;
-a; <span class="co">// -4</span></code></pre>
<h4 id="section-2">*</h4>
<p>The Multiplication operator takes two arguments and, if both of them are numbers, creates a value that is the product of the operand numbers.</p>
<h4 id="section-3">/</h4>
<p>The Division operator takes two arguments and, if both of them are numbers, creates a value that is the result of dividing the left hand operand by the right hand operand.</p>
<h4 id="section-4">%</h4>
<p>The Remainder operator takes two arguments and, if both of them are numbers, creates a value that is the integer remainder of dividing the left hand operand by the right hand operand, where the result’s sign is the one of the left hand operand.</p>
<h4 id="section-5">++ / –</h4>
<p>The increment and decrement operators each take one argument. They can be written before or after a qualified or unqualified variable name and have the effect of incrementing or decrementing the variable’s value respectively. If the operator precedes the operand, the new value is also returned by the expression, otherwise, the old value is returned.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> a = <span class="dv">0</span>;
a++; <span class="co">// 0</span>
a; <span class="co">// 1</span>
++a; <span class="co">// 2</span>
--a; <span class="co">// 1</span></code></pre>
<h3 id="assignment-operators">Assignment operators</h3>
<h4 id="section-6">=</h4>
<p>The Assignment operator is a very basic and very important one. It is used with two operands like so <code>op0 = op1</code> and what it does is, it assigns a variable, specified by the left hand operand, a value, specified by the right hand operator.</p>
<p>There are special assignment operators for all arithmetic and bitwise operations. These assignment operators use the value of the left hand operand for the left hand operand of their arithmetic/bitwise operation and then assign their left hand operator the result of the calculation the have performed.</p>
<p>That means that the following two assignments are completely identical:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">a += b;
a = a + b;</code></pre>
<p>The combined assignment operators are:</p>
<ul>
<li><code>+=</code></li>
<li><code>-=</code></li>
<li><code>*=</code></li>
<li><code>/=</code></li>
<li><code>%=</code></li>
<li><code>&amp;=</code></li>
<li><code>|=</code></li>
<li><code>&lt;&lt;=</code></li>
<li><code>&gt;&gt;=</code></li>
<li><code>&gt;&gt;&gt;=</code></li>
</ul>
<p>The operations performed, are explained in the following paragraphs.</p>
<h3 id="bitwise-operators">Bitwise Operators</h3>
<h4 id="section-7">&amp;</h4>
<p>The bitwise AND operator treats his operands as 32bit values and performs a bitwise and-operatoration.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="dv">7</span> &amp; <span class="dv">5</span> <span class="co">// 5</span>
<span class="dv">6</span> &amp; <span class="dv">1</span> <span class="co">// 0</span>
<span class="dv">3</span> &amp; <span class="dv">6</span> <span class="co">// 2</span></code></pre>
<h4 id="section-8">|</h4>
<p>The bitwise OR operator treats his operands as 32bit values and performs a bitwise or-operation.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="dv">7</span> | <span class="dv">5</span> <span class="co">// 7</span>
<span class="dv">4</span> | <span class="dv">1</span> <span class="co">// 5</span>
<span class="dv">1</span> | <span class="dv">2</span> <span class="co">// 3</span></code></pre>
<h4 id="section-9">^</h4>
<p>The bitwise XOR operator treats his operands as 32bit values and performs a bitwise xor-operation.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="dv">7</span> ^ <span class="dv">5</span> <span class="co">// 2</span>
<span class="dv">6</span> ^ <span class="dv">1</span> <span class="co">// 7</span>
<span class="dv">4</span> ^ <span class="dv">1</span> <span class="co">// 5</span></code></pre>
<h4 id="section-10">~</h4>
<p>The bitwise NOT operator treats his operand as a 32bit value and inverts every of the operands bits. Since the values are encoded as One’s Complement, <code>~a</code> will result in <code>-(a+1)</code>.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">~<span class="dv">5</span> <span class="co">// -6</span>
~<span class="dv">234324</span> <span class="co">// -234324</span>
~(-<span class="dv">1001</span>) <span class="co">// 1000</span></code></pre>
<h4 id="section-11">&lt;&lt; / &gt;&gt; / &gt;&gt;&gt;</h4>
<p>The shift operators in JavaScript are the left shift <code>&lt;&lt;</code>, the sign-propagating right shift <code>&gt;&gt;</code> and the zero-fill right shift <code>&gt;&gt;&gt;</code>. They convert their first operand to a 32bit value, shift it the amount specified by the second operand and convert it back. Because of the conversion (values in JavaScript are internally not represented as 32bit values), shifting in JavaScript has none of the performance benefits it has in other languages, which is why you won’t be needing these a lot.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="dv">7</span> &lt;&lt; <span class="dv">5</span> <span class="co">// 224</span>
-<span class="dv">6</span> &gt;&gt; <span class="dv">1</span> <span class="co">// -3</span>
-<span class="dv">6</span> &gt;&gt;&gt; <span class="dv">1</span> <span class="co">// 2147483645</span></code></pre>
<h3 id="comparison-operators">Comparison operators</h3>
<h4 id="section-12">===== / !====</h4>
<p>These equality and inequality operators compare the operands with which they are used. If the right hand side and left hand side operands are of the same type and have the same value, the equality operator produces the value <code>true</code> and the inequality operator produces the value <code>false</code>. If the compared operands have either different types or contain different values, the equality operator produces <code>false</code> and the inequality operator produces <code>true</code>.</p>
<pre><code>&#39;a&#39; === &#39;a&#39; // true
2 !== 2 // false
&#39;e&#39; !== &#39;a&#39; // true
{ } === { } // false</code></pre>
<p>When used with two objects that are not references to the same object, the equality operator always produces false.</p>
<p>NOTICE: It appears, that the <code>NaN</code> value is not equal to itself:</p>
<pre><code>NaN === NaN // false
NaN == NaN // false</code></pre>
<p>That is not only unintuitive, it is simply wrong. And it can easily lead to bugs. If you want to check, whether a value is NaN try this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">Number</span>.<span class="fu">isNaN</span> = <span class="kw">function</span> (n) {
    <span class="kw">return</span> (<span class="st">&#39;&#39;</span>+n) === <span class="st">&#39;NaN&#39;</span>;
};
<span class="co">// or</span>
<span class="ot">Number</span>.<span class="fu">isNaN</span> = <span class="kw">function</span> (n) {
    <span class="kw">return</span> n !== n;
};</code></pre>
<p>There will be a <code>Number.isNaN</code> function available by default in ECMAScript 6 and is already widely supported.</p>
<h4 id="section-13">== / !=</h4>
<p>These are also equality and inequality operators, but behave a bit differently. If the types of the compared operands do not match, these abstract comparison operators <code>==</code> and <code>!=</code> try to convert them into values of the same type and then compare their values. This process of type coercion has a lot of implementation faults (which are both sad and funny):</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="st">&#39;&#39;</span> == <span class="dv">0</span> <span class="co">// true</span>
<span class="dv">0</span> == <span class="st">&#39;0&#39;</span> <span class="co">// true</span>
<span class="st">&#39;&#39;</span> == <span class="st">&#39;0&#39;</span> <span class="co">// false</span>

<span class="kw">false</span> == <span class="st">&#39;&#39;</span> <span class="co">// true</span>
<span class="kw">false</span> == <span class="st">&#39;0&#39;</span> <span class="co">// true</span>
<span class="kw">false</span> == <span class="st">&#39;false&#39;</span> <span class="co">// false</span>

<span class="kw">undefined</span> == <span class="kw">null</span> <span class="co">// true</span>
<span class="kw">false</span> == [] <span class="co">// true</span>
<span class="kw">false</span> == {} <span class="co">// false</span>

<span class="st">&#39; </span><span class="ch">\t</span><span class="st"> </span><span class="ch">\n</span><span class="st">  &#39;</span>  == <span class="dv">0</span> <span class="co">// true</span></code></pre>
<p>Because of these, you should never use this kind of equality operator and always use the working one <code>===</code>/<code>!==</code>. Not only do <code>==</code>/<code>!=</code> not work reliably, but when reading someone’s code, it is not clear, whether the programmer was aware of their hazards or unintentionally used the fuzzy version of equality checks. When code hides the programmer’s real intention, it is bad code. You should write good code, so avoid <code>==</code> and <code>!=</code>.</p>
<h4 id="section-14">&lt;, &lt;=, &gt;, &gt;=</h4>
<p>The less than, less than or equal, greater than and greater than or equal operators behave similarly in that they compare the value of two operands.</p>
<p>Less than <code>&lt;</code> returns true, if the left operand’s value is less than the second operand’s value.</p>
<p>Less than or equal <code>&lt;=</code> returns true, if the left operand’s value is less than or equal to the second operand’s value.</p>
<p>Greater than <code>&gt;</code> returns true, if the left operand’s value is greater than the second operand’s value.</p>
<p>Greater than or equal <code>&gt;=</code> returns true, if the left operand’s value is greater than or equal to the second operand’s value.</p>
<p>Both operands are converted to number by the above operators. The usual rules apply like <code>null</code>, <code>[]</code> and <code>false</code> act as <code>0</code>, <code>true</code> acts as <code>1</code> and objects and <code>undefined</code> act as <code>NaN</code> rendering every comparison <code>false</code>.</p>
<h3 id="logical-operators">Logical Operators</h3>
<h4 id="section-15">&amp;&amp;</h4>
<p>The logical AND operator returns the value of the first operand, if its value is falsy (meaning that it evaluates to <code>false</code>, when being converted to a boolean), and the value of its second operand otherwise.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">true</span> &amp;&amp; <span class="st">&#39;34&#39;</span> <span class="co">// &#39;34&#39;</span>
<span class="dv">0</span> &amp;&amp; <span class="kw">true</span> <span class="co">// 0</span></code></pre>
<p>Because the AND operator returns the second operand, you can use it to safely call functions on object of which you are not sure, they exist.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">myObj &amp;&amp; <span class="ot">myObj</span>.<span class="fu">callMethod</span>();</code></pre>
<p>Because of the lazy validation, the function invocation expression is not evaluated if the first operand of the AND operator already evaluated to <code>false</code>.</p>
<h4 id="section-16">||</h4>
<p>The logical OR operator returns the value of the first operand, if its value is truthy (meaning that it evaluates to <code>true</code>, when being converted to a boolean), and the value of its second operand otherwise.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">undefined</span> || { } <span class="co">// { }</span>
<span class="kw">false</span> || <span class="kw">true</span> <span class="co">// true</span>
<span class="dv">3</span> || <span class="dv">4</span> <span class="co">// 3</span></code></pre>
<p>Because the OR operator returns the first operand, you can use it as a short notation for default parameters (which will be natively available in ES6).</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> f = <span class="kw">function</span> (obj0) {
    <span class="kw">var</span> o = obj0 || {};
};</code></pre>
<h4 id="section-17">!</h4>
<p>The logical NOT operator takes one operand and if its value is truthy, <code>false</code> is returned, and <code>true</code> otherwise.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">!<span class="dv">0</span> <span class="co">// true</span>
!{} <span class="co">// false</span></code></pre>
<h3 id="object-related-operators">Object-related operators</h3>
<h4 id="delete">delete</h4>
<p>The <code>delete</code> operator takes one argument that is expected to be a qualified variable name. The specified variable is removed from the object whose property it is.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> obj = { <span class="dt">foo </span>: <span class="st">&#39;bar&#39;</span> };
<span class="ot">console</span>.<span class="fu">log</span>(<span class="ot">obj</span>.<span class="fu">foo</span>); <span class="co">// &#39;bar&#39;</span>
<span class="kw">delete</span> <span class="ot">obj</span>.<span class="fu">foo</span>; <span class="co">// true</span>
<span class="ot">console</span>.<span class="fu">lo</span>(<span class="ot">obj</span>.<span class="fu">foo</span>); <span class="co">// undefined</span></code></pre>
<p>Using <code>delete</code> is preferred to setting an object’s value to <code>undefined</code>.</p>
<h4 id="in">in</h4>
<p>The <code>in</code> operator returns a boolean value stating whether an object has the property, specified by a string.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> obj = { <span class="dt">foo </span>: <span class="st">&#39;bar&#39;</span> };
<span class="ot">console</span>.<span class="fu">log</span>(<span class="st">&#39;foo&#39;</span> <span class="kw">in</span> obj); <span class="co">// true</span>
<span class="ot">console</span>.<span class="fu">log</span>(<span class="st">&#39;key&#39;</span> <span class="kw">in</span> obj); <span class="co">// false</span></code></pre>
<p>The <code>in</code> operator will return <code>true</code>, if a value has been set to <code>undefined</code>, but <code>false</code>, if it has been deleted with the <code>delete</code> operator.</p>
<h4 id="instanceof">instanceof</h4>
<p>The <code>instanceof</code> operator returns a boolean value stating whether an object was created by a given constructor or a constructor inheriting from it. (This will make more sense, when we talk about inheritance in <a href="#XX.XX">XX.XX</a>);</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> Constr0 = <span class="kw">function</span> () { };
<span class="kw">var</span> Constr1 = <span class="kw">function</span> () { };

<span class="kw">var</span> insta0 = <span class="kw">new</span> <span class="fu">Constr0</span>();
insta0 <span class="kw">instanceof</span> Constr0; <span class="co">// true</span>
insta0 <span class="kw">instanceof</span> Constr1; <span class="co">// false</span>

<span class="ot">Constr1</span>.<span class="fu">prototype</span> = <span class="kw">new</span> <span class="fu">Constr0</span>();
<span class="kw">var</span> insta1 = <span class="kw">new</span> <span class="fu">Constr1</span>();
insta1 <span class="kw">instanceof</span> Constr1; <span class="co">// true</span>
insta1 <span class="kw">instanceof</span> Constr0; <span class="co">// true</span></code></pre>
<h4 id="new">new</h4>
<p>The <code>new</code> operator takes one operand that is a function value. It creates a new object, that inherits from the function’s prototype, invokes that function (optionally specifying parameter values) with <code>this</code> bound to the new object and returns the new object (if the function does not specify any other return value) as the value of the whole <code>new</code> expression.</p>
<p>If that sounds a bit cryptic, read <a href="#XX.XX">XX.XX</a> and <a href="#XX.XX">XX.XX</a> where objects and functions are covered respectively. Especially, <code>new</code> is discussed again in <a href="#XX.XX">XX.XX</a>.</p>
<h3 id="other-operators">Other operators</h3>
<h4 id="conditional">Conditional</h4>
<p>The conditional operator is the only operator in JavaScript taking three operands. It evaluates the first operand, if the result of that evaluation is true, the second one will be evaluated, if not, the third one will be. You can think of the conditional operator as a short way of writing an if-else statement (but with mandatory else).</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> status = <span class="fu">isReady</span>() ? <span class="st">&#39;I am ready!&#39;</span> : <span class="st">&#39;Wait a sec!&#39;</span>;</code></pre>
<h4 id="typeof">typeof</h4>
<p>JavaScript has a <code>typeof</code> operator that takes one operand and creates a new value that is a string describing the operand’s type.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">typeof</span> <span class="st">&#39;foo&#39;</span> <span class="co">// &#39;string&#39;</span>
<span class="kw">typeof</span> <span class="dv">42</span> <span class="co">// &#39;number&#39;</span>
<span class="kw">typeof</span> { } <span class="co">// &#39;object&#39;</span>
<span class="kw">typeof</span> <span class="kw">false</span> <span class="co">// &#39;boolean&#39;</span>
<span class="kw">typeof</span> <span class="kw">undefined</span> <span class="co">// &#39;undefined&#39;</span></code></pre>
<p>Although there is no <code>function</code> type in JavaScript, functions are recognized as such by <code>typeof</code>.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">typeof</span> <span class="kw">function</span> () { }; <span class="co">// &#39;function&#39;</span></code></pre>
<p>While that is all very well, consider the following:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">typeof</span> [ ] <span class="co">// &#39;object&#39;</span></code></pre>
<p>Sadly, the <code>typeof</code> operator recognizes arrays as being objects, which is not totally wrong but at least not useful. Since ECMAScript 5.1 there is an <code>Array.isArray</code> method to reliably check for an array. For legacy environments, you could write your own polyfill:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">if</span> (!<span class="ot">Array</span>.<span class="fu">isArray</span>) {
    <span class="ot">Array</span>.<span class="fu">isArray</span> = <span class="kw">function</span> (a) {
        <span class="kw">return</span> <span class="ot">Object</span>.<span class="ot">prototype</span>.<span class="ot">toString</span>.<span class="fu">call</span>(a) === <span class="st">&#39;[object Array]&#39;</span>;
    };
}</code></pre>
<p>But there is more:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">typeof</span> <span class="kw">null</span> <span class="co">// &#39;object&#39;</span></code></pre>
<p>This is a mistake that might get fixed in some future version of JavaScript, but until then, you have to keep this flaw in mind.</p>
<p>What is maybe even more troublesome, is that:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">typeof</span> <span class="kw">NaN</span> <span class="co">// &#39;number&#39;</span></code></pre>
<p>While you would expect “Not a Number” not to be a number, technically it is. There is a global <code>isNaN</code> function, but you should not be using it, since it is broken. (It tries to convert non-numeric arguments to the Number type and then tries to determine, whether that number is<code>NaN</code>, which gives false negatives in those cases.) In ECMAScript 6 there will be a <code>Number.isNaN</code> function and it is already supported in Firefox 15+ and Chrome 25+ (thus V8 thus nodeJS)</p>
<p>For a more robust check for a value being a number or not, you should use something like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">Number</span>.<span class="fu">isNumber</span> = <span class="kw">function</span> (n) {
    <span class="kw">return</span> <span class="kw">typeof</span> n === <span class="st">&#39;number&#39;</span> &amp;&amp; (<span class="st">&#39;&#39;</span> + n) !== <span class="st">&#39;NaN&#39;</span> &amp;&amp; n !== <span class="kw">Infinity</span> &amp;&amp; n !== -<span class="kw">Infinity</span>;
};</code></pre>
<p>Implmentations differ in the way, their <code>typeof</code> operator labels regular expressions. They are most of the time recognized as <code>object</code> and sometimes as <code>function</code>, but never <code>regex</code> or something like that.</p>
<h4 id="void">void</h4>
<p>The void operator evaluates the expression which is its only operand and ignoring the expressions value, creates a new value of <code>undefined</code>.</p>
<p>This may sound a bit silly and is indeed of limited use. But the <code>void</code> operator allows to insert expressions, that have side effects, into places, where a value of <code>undefined</code> is required for correct behavior - which may be an indicator that you have to rethink you code, instead of using void.</p>
<p>The most frequent use of <code>void</code> is in an HTML anchor tag:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;javascript:void(document.body.backgroundColor = &#39;red&#39;)&quot;</span><span class="kw">&gt;</span>Click here<span class="kw">&lt;/a&gt;</span></code></pre>
<p>The expression has the side effect of manipulating the attribute of a DOM element and would return <code>'red'</code> which is not desired to be inserted inside the anchor tag’s <code>href</code> attribute.</p>
<h4 id="yield">yield</h4>[...]
<h3 id="operator-precedence">Operator Precedence</h3>
<p>Operator precedence determines the order in which operations are evaluated.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="dv">5</span> * <span class="dv">3</span> + <span class="dv">4</span> = <span class="dv">19</span>
<span class="dv">5</span> + <span class="dv">3</span> * <span class="dv">4</span> = <span class="dv">17</span></code></pre>
<p>In maths, multiplication has a higher precedence than addition. Similarly, in JavaScript the multiplication operator <code>*</code> has a higher precedence than the plus operator <code>+</code>; i.e. the multiplication operator binds values stronger.</p>
<p>You can force an evaluation order on a chained operation by using parentheses.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="dv">5</span> * (<span class="dv">3</span> + <span class="dv">4</span>) = <span class="dv">17</span></code></pre>
<p>If every operation would be enclosed in parentheses, operator precedence would be irrelevant and expressions would be evaluated from the inner most to the outer most pair of parentheses.</p>
<p>Along with the precedence hierarchy for different operators, associativity determines the precedence among equal operators.</p>
<p>The following table shows operator’s precedences and their associativity in JavaScript:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Precedence</th>
<th style="text-align: left;">Operator</th>
<th style="text-align: left;">Operation</th>
<th style="text-align: left;">Associativity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;"><code>new</code></td>
<td style="text-align: left;">constructor invocation</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;"><code>()</code></td>
<td style="text-align: left;">function invocation</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;"><code>[]</code>/<code>.</code></td>
<td style="text-align: left;">property access</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;"><code>++</code>/<code>--</code></td>
<td style="text-align: left;">increment/decrement</td>
<td style="text-align: left;">none</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;"><code>!</code></td>
<td style="text-align: left;">logical NOT</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;"><code>~</code></td>
<td style="text-align: left;">bitwise NOT</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;"><code>+</code></td>
<td style="text-align: left;">unary plus (type-conversion)</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;"><code>-</code></td>
<td style="text-align: left;">unary minus (negation)</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: left;"><code>typeof</code></td>
<td style="text-align: left;">typeof</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: left;"><code>void</code></td>
<td style="text-align: left;">void</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: left;"><code>delete</code></td>
<td style="text-align: left;">property removal</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: left;"><code>*</code></td>
<td style="text-align: left;">multiplication</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: left;"><code>/</code></td>
<td style="text-align: left;">division</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="even">
<td style="text-align: left;">13</td>
<td style="text-align: left;"><code>%</code></td>
<td style="text-align: left;">remainder</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14</td>
<td style="text-align: left;"><code>+</code></td>
<td style="text-align: left;">addition</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="even">
<td style="text-align: left;">15</td>
<td style="text-align: left;"><code>-</code></td>
<td style="text-align: left;">subtraction</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="odd">
<td style="text-align: left;">16</td>
<td style="text-align: left;"><code>&lt;&lt;</code>/<code>&gt;&gt;</code>/<code>&gt;&gt;&gt;</code></td>
<td style="text-align: left;">bitwise shift</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="even">
<td style="text-align: left;">17</td>
<td style="text-align: left;"><code>&lt;</code>/<code>&lt;=</code>/<code>&gt;</code>/<code>&gt;=</code></td>
<td style="text-align: left;">comparison</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="odd">
<td style="text-align: left;">18</td>
<td style="text-align: left;"><code>in</code></td>
<td style="text-align: left;">property membership check</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="even">
<td style="text-align: left;">19</td>
<td style="text-align: left;"><code>instanceof</code></td>
<td style="text-align: left;">instanceof</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20</td>
<td style="text-align: left;"><code>==</code>/<code>!=</code>/<code>===</code>/<code>!==</code></td>
<td style="text-align: left;">equality / inequality</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="even">
<td style="text-align: left;">21</td>
<td style="text-align: left;"><code>&amp;</code></td>
<td style="text-align: left;">bitwise AND</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="odd">
<td style="text-align: left;">22</td>
<td style="text-align: left;"><code>|</code></td>
<td style="text-align: left;">bitwise OR</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="even">
<td style="text-align: left;">23</td>
<td style="text-align: left;"><code>^</code></td>
<td style="text-align: left;">bitwise XOR</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="odd">
<td style="text-align: left;">24</td>
<td style="text-align: left;"><code>&amp;&amp;</code></td>
<td style="text-align: left;">logical AND</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="even">
<td style="text-align: left;">25</td>
<td style="text-align: left;"><code>||</code></td>
<td style="text-align: left;">logical OR</td>
<td style="text-align: left;">left</td>
</tr>
<tr class="odd">
<td style="text-align: left;">26</td>
<td style="text-align: left;"><code>? :</code></td>
<td style="text-align: left;">conditional</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="even">
<td style="text-align: left;">27</td>
<td style="text-align: left;"><code>yield</code></td>
<td style="text-align: left;">yield</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="odd">
<td style="text-align: left;">28</td>
<td style="text-align: left;"><code>=</code>/<code>+=</code>/<code>-=</code>/<code>*=</code>/<code>/=</code>…</td>
<td style="text-align: left;">assignment</td>
<td style="text-align: left;">right</td>
</tr>
<tr class="even">
<td style="text-align: left;">29</td>
<td style="text-align: left;"><code>,</code></td>
<td style="text-align: left;">comma</td>
<td style="text-align: left;">left</td>
</tr>
</tbody>
</table>
<h2 id="coercion">Coercion</h2>
<p>In some situations the JavaScript interpreter will expect values of specific types e.g. operators tend to work only on certain types or <code>if</code> statements expect their condition to be a boolean value. When a value of the wrong type is given to an operator or a statement, the interpreter tries to convert the value to the expected type. Because of the brutality with which the conversion is enforced in order to avoid throwing, this process is called “coercion”. Especially for the <code>+</code> and <code>==</code> operator there is some tricky behavior in how that conversion is done.</p>
<h3 id="truthiness-and-falsiness">Truthiness and Falsiness</h3>
<p>Here I want to talk about the conversion to boolean values as present in <code>if</code>, <code>while</code> and <code>for</code> statements, the ternary operator and logical operators.</p>
<p>Some values are automatically converted to <code>false</code>. We call those “falsy values”. Falsy values are the following:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">false</span>
<span class="dv">0</span>
<span class="kw">NaN</span>
<span class="st">&#39;&#39;</span>
<span class="kw">undefined</span>
<span class="kw">null</span></code></pre>
<p>All other values are considered “truthy” meaning they evaluate to <code>true</code> when converted to a boolean. It is actually easy to understand, why the above values become <code>false</code> when converted to a boolean value. The concept of truthiness/falsiness is not too complex as long as you remember that it is about coercing a value to the boolean type.</p>
<p>You can btw. easily write a function to test for truthiness.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> isTruthy = <span class="kw">function</span> (val) {
    <span class="kw">if</span> (val) {
        <span class="kw">return</span> <span class="kw">true</span>;
    } <span class="kw">else</span> {
        <span class="kw">return</span> <span class="kw">false</span>;
    }
};
<span class="kw">var</span> isFalsy = <span class="kw">function</span> (val) { <span class="kw">return</span> !<span class="fu">isTruthy</span>(val); };</code></pre>
<p>There is another (shorter) way to convert a value to the boolean type: By prefixing it with two negation <code>!</code> operators.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">!!<span class="dv">0</span> <span class="co">// false</span>
!!<span class="dv">1</span> <span class="co">// true</span>
!!<span class="kw">NaN</span> <span class="co">// false</span>
!!<span class="st">&#39;&#39;</span> <span class="co">// false</span>
!!<span class="st">&#39;0&#39;</span> <span class="co">// true</span>
!!<span class="st">&#39;undefined&#39;</span> <span class="co">// false</span>
!!<span class="st">&#39;null&#39;</span> <span class="co">// false</span></code></pre>
<p>The negation operator converts its operand to a boolean value and then negates it; by doing that twice we get the correct result which complies with the language’s understanding of falsiness.</p>
<h3 id="abstract-comparison-operator">Abstract comparison operator</h3>
<p>Sadly, the comparison operator in JavaScript is not compatible with the falsiness and truthiness of values.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="fu">isTruthy</span>(<span class="st">&#39;0&#39;</span>) <span class="co">// true</span>
<span class="kw">true</span> == <span class="st">&#39;0&#39;</span> <span class="co">// false</span>

<span class="fu">isFalsy</span>(<span class="kw">undefined</span>) <span class="co">// true</span>
<span class="kw">false</span> == <span class="kw">undefined</span> <span class="co">// false</span>

<span class="fu">isTruthy</span>([]) <span class="co">// true</span>
<span class="kw">false</span> == [] <span class="co">// true</span></code></pre>
<p>Consider this operator trying to do a conversion to the number type. Let us examine the examples closer. <code>'0'</code> is a string that is not empty and is thus considered truthy (the empty string is the only string considered falsy). When using the abstract comparison operator true is converted to a number, resulting in the number <code>1</code>. Then <code>'0'</code> is converted to a number, which rationally makes the number <code>0</code>.</p>
<p><code>undefined</code> is one of the falsy values, but while <code>false</code> is coerced to the number <code>0</code>, <code>undefined</code> is always <code>NaN</code> in a numeric context and so it does make sense that <code>false == undefined</code> is <code>false</code>. To be honest with you: The internal logic works slightly differently, but it’s best if you think of it this way. Otherwise, feel free to consult the Abstract Equality Comparison Algorithm in ECMA262-5.1 11.9.3.</p>
<p>An empty array is an object (just as any other array) and objects are always truthy. But when coerced to a number, an empty array becomes <code>0</code> just like <code>false</code> becomes <code>0</code>, which is why both are considered equal by the abstract comparison operator.</p>
<p>Sadly, the specification does not enforce the to-number coercion for every combination of operands. The only example I could come up with, that contradicts the simplified understanding of the abstract equality comparison is the value <code>null</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">false</span> == <span class="kw">null</span> <span class="co">// false</span>
+<span class="kw">false</span> == +<span class="kw">null</span> <span class="co">// true</span>

<span class="kw">undefined</span> == <span class="kw">null</span> <span class="co">// true</span>
+<span class="kw">undefined</span> == +<span class="kw">null</span> <span class="co">// false</span>

<span class="dv">0</span> == <span class="kw">null</span> <span class="co">// false</span>
+<span class="dv">0</span> == +<span class="kw">null</span> <span class="co">// true</span>

<span class="st">&#39;0&#39;</span> == <span class="kw">null</span> <span class="co">// false</span>
+<span class="st">&#39;0&#39;</span> == +<span class="kw">null</span> <span class="co">// true</span>

<span class="st">&#39;&#39;</span> == <span class="kw">null</span> <span class="co">// false</span>
+<span class="st">&#39;&#39;</span> == +<span class="kw">null</span> <span class="co">// true</span>

[] == <span class="kw">null</span> <span class="co">// false</span>
+[] == +<span class="kw">null</span> <span class="co">// true</span>

<span class="co">// but</span>

<span class="kw">null</span> == {} <span class="co">// false</span>
+<span class="kw">null</span> == +{} <span class="co">// false</span></code></pre>
<p>Summing up: The abstract equality operator behaves just like the strict one when both operands are of the same type. Otherwise he coerces them to numbers and performs a strict comparison. Strict comparisons are intuitive. Actually you should never use the abstract equality operator. (The same goes for the abstract inequality operator of course.)</p>
<h3 id="number-coercion">Number coercion</h3>
<p>Now we already had values implicitly coerced to the number type, but what is the best way to do it explicitly? There are several options that shall not be discussed to detailed.</p>
<pre><code>new Number(&#39;42&#39;).valueOf() // 42
&#39;42&#39; / 1 // 42
&#39;42&#39; - 0 // 42
&#39;42&#39; * 1 // 42
+&#39;42&#39; // 42
parseFloat(&#39;42&#39;) // 42
parseInt(&#39;42&#39;) // 42
&#39;42&#39;|0 // 42
&#39;42&#39;^0 // 42
~~&#39;42&#39; // 42</code></pre>
<p>These are all the techniques to convert a string value to a number roughly sorted by performance from slow (top) to fast (bottom) (based on these <a href="http://jsperf.com/string-to-number-conversion-perf">these</a> <a href="http://jsperf.com/best-of-string-to-number-conversion/4">three</a> <a href="http://jsperf.com/string-to-number-conversion-test">jsperf</a> benchmarks and some more). The above methods are interchangeable for strings containing integers. If the string contains decimal numbers, <code>parseInt</code> and the bitwise operators will cut of the fractional part and return just the integer part of the number while the arithmetic operators and <code>parseFloat</code> return the correct decimal number. <code>null</code> is converted to <code>0</code> by all of the above except for <code>parseFloat</code> and <code>parseInt</code> which produce <code>NaN</code>. <code>undefined</code> is converted to <code>NaN</code> by all of them except for the bitwise operators which produce <code>0</code>. The same goes for the empty array. An array with one numeric value is converted to that numeric value by all of the above. Arrays with multiple numeric values are converted to <code>0</code> by the bitwise operators, to the first number in the array by <code>parseInt</code> and <code>parseFloat</code> and to <code>NaN</code> by the arithmethic operators. I will not talk about objects or arrays with non-numeric values or whatsoever but probably you got the point, being that you should be careful with numeric conversions. They never throw an error. Avoid converting anything else but strings that contain numbers. If the string contains only non-numeric characters, it gets converted to <code>NaN</code> except for the bitwise operators that will create <code>0</code>. If the string contains digits and other characters, the arithmetic operators return <code>NaN</code>, the bitwise operators return <code>0</code> and <code>parseFloat</code> and <code>parseInt</code> try to parse everything before the first non-numeric character and ignore the rest (again: without an error or anything).</p>
<h2 id="variables">Variables</h2>
<h3 id="identifiers">Identifiers</h3>
<p>Variable names have to comply to simple naming restrictions. The name of a variable (or constant) no matter, what it contains is called an identifier. Identifiers may only be composed of letters, digits and the underscore character <code>_</code> and may not start with a digit.</p>
<h3 id="variable-declaration">Variable Declaration</h3>
<p>A variable declaration consists of the <code>var</code> keyword, followed by a space, followed by an identifier. The declaration can be immediately followed by an assignment to the new variable, in which case the identifier is followed by a space, the assignment operator <code>=</code> and an expression. Declaring and instantly assigning a value is called definition. Multiple declarations and and definitions can be chained together by using the comma operator <code>,</code>. A declaration or definition or chain of comma separated declarations or definitions has to be followed by a semicolon.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> x = <span class="dv">3</span>;
<span class="ot">console</span>.<span class="fu">log</span>(x); <span class="co">// 3</span>
x = <span class="st">&#39;a string value&#39;</span>;
<span class="ot">console</span>.<span class="fu">log</span>(x); <span class="co">// &#39;a string value&#39;</span>

<span class="kw">var</span> y = <span class="st">&#39;Why not?&#39;</span>, z, answer = <span class="dv">42</span>;
<span class="ot">console</span>.<span class="fu">log</span>(y); <span class="co">// &#39;Why not?&#39;</span>
<span class="ot">console</span>.<span class="fu">log</span>(u); <span class="co">// undefined</span></code></pre>
<p>The <code>var</code> keyword creates a variable in the local scope of the function. Read more about scope in <a href="#04.03.00">04.03</a></p>
<h3 id="hoisting">Hoisting</h3>
<p>JavaScript uses a concept called “hoisting” that moves every variable declaration to the top of the function, while its definition is not.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> f = <span class="kw">function</span> (d, c) {
    <span class="fu">c</span>(d);
    <span class="kw">var</span> a = c;
};
<span class="co">// becomes:</span>
<span class="kw">var</span> f = <span class="kw">function</span> (d, c) {
    <span class="kw">var</span> a;
    <span class="fu">c</span>(d);
    a = c;
};</code></pre>
<p>The result of that is that you can use variables before they are defined in your code without getting any errors. But since only the declaration not the definition is hoisted and declared variables are initialized with the <code>undefined</code> value, that may cause trouble.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> f = <span class="kw">function</span> () {
    <span class="ot">console</span>.<span class="fu">log</span>(r2);
    <span class="kw">var</span> r2 = <span class="st">&#39;d2&#39;</span>;
    <span class="ot">console</span>.<span class="fu">log</span>(r2);
    <span class="ot">console</span>.<span class="fu">log</span>(c3);
};
<span class="fu">f</span>();
<span class="co">// undefined</span>
<span class="co">// &#39;d2&#39;</span>
<span class="co">// ReferenceError: c3 is not defined</span></code></pre>
<p>The declaration of <code>r2</code> is hoisted to the top of the function and the variable is initialized with <code>undefined</code>. In contrast, accessing <code>c3</code> will result in an error, since <code>c3</code> was not declared at all.</p>
<h3 id="variable-assignment">Variable Assignment</h3>
<p>It is possible to assign a value to a variable that has not previously been declared. There is no error and chances are, the program will work fine. The problem is, that such an assignment creates an implicit declaration of a global variable. Since global variables are visible everywhere inside your program, the probability of a name collision has to be taken into account. It is best, to keep variables as private and local as possible and always to avoid globals. (Read more on scope in <a href="#04.03.00">04.03</a>).</p>
<h3 id="constant-declaration">Constant Declaration</h3>
<p>Another way to create containers for values is by using constants. The <code>const</code> keyword behaves syntacially like the <code>var</code> keyword, but creates a variable, that can be assigned a value only once. After its initial definition, a constant is readonly. If you try to change a constant you do not get an error message, but the value of the constant will simply not change.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">const</span> PI = <span class="fl">3.141592653589793</span>;
<span class="ot">console</span>.<span class="fu">log</span>(PI); <span class="co">// 3.141592653589793</span>
PI = <span class="dv">3</span>;
<span class="ot">console</span>.<span class="fu">log</span>(PI); <span class="co">// 3.141592653589793</span></code></pre>
<p>If you declare a constant without immediately assigning it a value, that creates a constant with the value of <code>undefined</code>, which can not be changed, so you practically have to assign a value right away.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">const</span> NOVALUE;
NOVALUE = <span class="st">&#39;value&#39;</span>;
<span class="ot">console</span>.<span class="fu">log</span>(NOVALUE); <span class="co">// undefined</span></code></pre>
<p>It is syntactically not required that constant names are all caps, but convention is to only use all caps names for constants in order to provide a visual clue on the fact that the value cannot be changed.</p>
<p>Constants are currently not part of the official JavaScript language specification, but they are very likely to be in the next version of the language and they are already supported in the most important environments. Irritatingly, in ECMAScript 6 constants are block scoped, but are function scoped in current implementations.</p>
<h3 id="declaration-with-let-es6">Declaration with <code>let</code> (ES6)</h3>
<p>Similar to <code>const</code> and <code>var</code>, <code>let</code> declares a variable with optional immediate assignment of a value. The difference being, that <code>let</code> is block scoped, while <code>var</code> is function scoped. More on scope in <a href="#04.03.00">04.03</a>. <code>let</code> can be used in different flavors (syntaxes). The first one is called <code>let</code> definition and looks just like the <code>var</code> or <code>const</code> syntax.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> answer = <span class="dv">42</span>;</code></pre>
<p>The second and third are similar. The <code>let</code> keyword is followed by a set of parentheses which contain one or more variable assignments. The third part of the construct is an expression (finishing up the <code>let</code> expression) or a statement (concluding the <code>let</code> statement).</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> name = <span class="st">&#39;Luke&#39;</span>;
<span class="kw">let</span> (name = <span class="st">&#39;Anakin&#39;</span>) <span class="ot">console</span>.<span class="fu">log</span>(name); <span class="co">// &#39;Anakin&#39;</span>
<span class="ot">console</span>.<span class="fu">log</span>(name); <span class="co">// &#39;Luke&#39;</span></code></pre>
<p>Since a block is a statement you can execute a piece of code with access to “private” variables.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> getSecret;
<span class="kw">let</span> (
    secret = <span class="dv">723590</span>
) {
    getSecret = <span class="kw">function</span> () {
        <span class="kw">return</span> secret;
    };
};
<span class="ot">console</span>.<span class="fu">log</span>(<span class="fu">getSecret</span>()); <span class="co">// 723590</span>
<span class="ot">console</span>.<span class="fu">log</span>(secret); <span class="co">// ReferenceError: secret is not defined</span></code></pre>
<h3 id="call-by-value-call-by-reference">Call-by-value / Call-by-reference</h3>
<p>The way in which variables are passed as function arguments is really simple. All primitive values are passed by value to function, all objects (including functions, arrays, regular expressions and all your custom objects) are passed by reference.</p>
<h2 id="bonus-automatic-semicolon-insert-asi">BONUS: Automatic Semicolon Insert (ASI)</h2>[...]
<h1 id="objects-part-i">03 Objects Part I</h1>
<p>Along with booleans, <code>null</code>, numbers, strings and <code>undefined</code>, objects are one of the types in JavaScript. As opposed to the other ones, which are called primitive types, objects are more complex constructs.</p>
<p>Objects are the very most important type in JavaScript. They are basically a set of key-value-pairs, which would be called Hash (Perl, Ruby) or HashMap (Java) or Dictionary (Python) or Associative Array (PHP) in other languages. In those languages, objects are thought of to be instances of classes. With classes being abstract concepts, objects are concrete things, that correspond to entities from the real world or the program’s problem domain. In JavaScript, there are no classes so objects stand for themselves and are simply collections of values.</p>
<h3 id="composition">Composition</h3>
<p>An object in JavaScript is a set of key-value-paris. The keys have to be strings, while the values can be of any type. A key-value-pair inside an object is referred to as its “property” or “member”.</p>
<h2 id="creation">Creation</h2>
<h3 id="object-literals">Object literals</h3>
<p>To create an object, the most convenient way is the object literal <code>{ }</code>. Curly braces not only describe blocks (<a href="#XX.XX">XX.XX</a>) but also objects. Inside the curly braces, you can specify zero or more comma-seperated key-value-pairs. The key can be a string and if it is also a valid identifier, it can also be written without quotation marks while still being treated as a string. The value can be any expression, like a number or string literal, a function expression, a conditional expression or another object.</p>
<pre><code>var jedi = {
    name : &#39;Luke Skywalker&#39;,
    yearOfBirth : -19,
    &#39;homeplanet&#39; : {
        &#39;name&#39; : &#39;Tatooine&#39;,
        &#39;rotPeriod&#39; : 23
    },
    friends : [ &#39;Leia Organa&#39;, &#39;Han Solo&#39;, &#39;Chewbacca&#39;]
};</code></pre>
<p>When the key is written as a string literal, it is allowed to be an arbitrary string, while it otherwise has to be a valid identifier.</p>
<h3 id="constructor">Constructor</h3>
<p>You can also create a new object by using a constructor function. Constructor functions or constructors are functions that create and return a new object. We will deal a lot with constructors in chapter 5. There are builtin constructors in JavaScript to create new empty objects or any of the primitive values.</p>
<pre><code>var o0 = new Object();
var b0 = new Boolean(&quot;true&quot;);</code></pre>
<p>Note that a constructor, just like any other function, can accept parameters.</p>
<p>An object, created by <code>new Object()</code> or an empty object literal <code>{}</code>, which are equivalent expressions, does not have any properties. Such an object is not very useful, but you can add properties to it.</p>
<h2 id="modification">Modification</h2>
<h3 id="property-access">Property Access</h3>
<p>There are two ways to access an object property: The dot notation and the subscript notation. The dot notation uses the the object value and the property’s name, separated by a dot <code>.</code>. The subscript notation consists of an object value, followed by a pair of square brackets enclosing a string that has the value of the property’s name.</p>
<pre><code>obj.prop;
obj[&#39;prop&#39;];</code></pre>
<p>The dot notation is easier to write, but since the subscript notation uses a string, you can place a variable, containing a string, inside the square brackets (which is a common pattern in loops for instance). Additionally, the subscript notation allows you to use property names that are not valid identifiers, which is not possible, using the dot notation. (More on identifiers in <a href="#XX.XX">XX.XX</a>). Since the subscript notation involves runtime evaluation of the property name, some optimizations in JavaScript engines may not apply, which is why you should dot notation when you don’t need to have a variable property name.</p>
<h3 id="updating-properties">Updating properties</h3>
<p>You can set any object property to any value. You access it like described above and simply assign it a value. There are no restrictions on type.</p>
<h3 id="deleting-properties">Deleting properties</h3>
<p>JavaScript has a <code>delete</code> operator that deletes a given property from an object. This is the prefered way of deleting object properties as opposed to simply setting their value to <code>undefined</code>. If you do the latter, the object will still contain the property, just with the value of <code>undefined</code>, and it will show up in <code>for in</code> loops and in <code>Object.keys</code></p>
<h3 id="inheritance">Inheritance</h3>
<p>There is a separate chapter on inheritance, but a certain effect of inheritance should be mentioned at this point.</p>
<p>Objects in JavaScript can inherit properties from other objects. An object, that is inherited from, is called the prototype of the object, that inherits from it. If a property is accessed on an object does not have a property with the given key, the JavaScript interpreter will check the object’s prototype, to see, if that has the requested property. If not, it will check its prototype and so on, until a special root object is reached. This root object is <code>Object.prototype</code> and inherits from nothing. You can read more on this prototype chain and how it is manipulated in chapter 5.</p>
<p>The prototype chain is not consulted when using the <code>delete</code> keyword or when the object has its own property with the given key.</p>
<p>A consequence of this prototype chain property lookup is, that you can append properties to Object.prototype that are then available on every object. This practice is called altering JavaScript’s prototyps and is usually to be done with caution since it can result in problems with code that does not expect altered prototypes. That is mainly because of the <code>for ... in</code> loop iterating over all of an object’s properties, including inherited once. You can circumvent this behavior in your own code using <code>hasOwnProperty</code> (as mentioned in <a href="#02.01.09">02.01.09</a>), which is strongly advised. In situations where your code runs alongside code from other sources on which you have limited or even no influence, you have to take special care. Read <a href="#XX.XX">XX.XX</a> for another technique to deal with this kind of problem.</p>
<h1 id="functions">04 Functions</h1>
<h2 id="definition">Definition</h2>
<p>When a function definition is evaluated by the compiler, a new object is created, that inherits from <code>Function.prototype</code>. A function can be defined in three ways.</p>
<h3 id="function-expression-function-literal">function expression (function literal)</h3>
<p>A function expression can be used anywhere where an expression is expected. It produces a new value representing the function and when you do not get hold of it, it is gone. The standard way to define a simple function is this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> f = <span class="kw">function</span> (param) {
    <span class="ot">console</span>.<span class="fu">log</span>(param);
};</code></pre>
<p>It consists of 1. the <code>function</code> keyword, 2. zero or more parameters enclosed in parentheses, 3. zero or more statements enclosed in curly braces (the function body). The fact that we assign the function value to a variable here is irrelevant.</p>
<p>Parameters are optional. They are local variables to the function body and are initialized with the values, passed as arguments when the function is invoked.</p>
<p>The function body can be empty. It can contain an arbitrary number of statements that will be executed in order unless the execution order is altered by loops, conditional statements or function invocations.</p>
<p>The return statement is optional. You can use the return statement to terminate the function’s execution early and/or to specify a return value. A return value can be any expression. Any function without a return statement will return the <code>undefined</code> value (unless the function was invoked with the <code>new</code> prefix). NOTICE: If the <code>return</code> keyword and the expression you want to return are separated by one or more newline characters, the function will return the <code>undefined</code> value and the expression after the <code>return</code> will be ignored. (That is because of Automatic Semicolon Insertion on which you can read more about in XX.XX).</p>
<h4 id="bonues-named-function-expression">BONUS: Named Function Expression</h4>
<p>Function expressions can optionally contain a name. The name is not visible outside of the function but inside of it and can be used by the function to call itself recursively. A function expression with a name is conveniently called a named function expression (NFE).</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> g1883r15h = <span class="kw">function</span> <span class="fu">factorial</span> (n) {
    <span class="kw">return</span> n &lt; <span class="dv">2</span> ? <span class="dv">1</span> : <span class="fu">factorial</span>(n<span class="dv">-1</span>) * n;
};</code></pre>
<p>Due to a bug in the ES3 spec that required implementations to create an object for the scope of NFEs, all properties of Object.prototype were visible inside the NFE’s function body. That circumstance lead to weirdness like the following:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> constructor = <span class="kw">function</span> () {
    <span class="kw">return</span> <span class="dv">42</span>;
};
<span class="kw">var</span> other = <span class="kw">function</span> <span class="fu">other</span> () {
    <span class="kw">return</span> <span class="fu">constructor</span>();
};
<span class="fu">other</span>(); <span class="co">// {}</span></code></pre>
<p>The call to <code>other</code> above would return an empty object in older browsers because the scope of <code>other</code> inherited all the properties from <code>Object.prototype</code>, one of them being <code>constructor</code>, a function that returns an empty object.</p>
<p>Also, Internet Explorer 8 and prior creates an additional local variable with the name in the function expression.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> f = <span class="kw">function</span> <span class="fu">g</span> () { };
<span class="kw">typeof</span> g; <span class="co">// &#39;function&#39;</span>
f === g; <span class="co">// false</span></code></pre>
<p>Even worse, it creates two distinct function objects (thus allocating twice as much memory).</p>
<p>In modern browsers, both of the above issues no longer exists and you can use NFEs to your liking.</p>
<h3 id="function-constructor">Function constructor</h3>
<p>Functions are objects and objects can be created by constructors. In JavaScript there is even a constructor for functions. You can use it to define new functions.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">    <span class="kw">new</span> <span class="fu">Function</span>(<span class="st">&#39;arg&#39;</span>, <span class="st">&#39;console.log(arg)&#39;</span>);</code></pre>
<p>The <code>new</code> keyword is optional, but omitting it leads to easier confusing with this notation and an anonymous function expression. You can specify the parameters, that your new function expects, as individual strings or as an array of strings. The function body is also expected to be a string.</p>
<p>Functions defined by a function constructor do not inherit any scope other than the global scope. (More on scope in XX.XX)</p>
<p>A function constructor’s function body string is parsed every time it is evaluated, which makes this approach slower than using function expressions or function declarations.</p>
<h3 id="function-declaration-function-statement">function declaration (function statement)</h3>
<p>A function declaration looks very similar to a function expression.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="fu">logger</span> (val) {
    <span class="ot">console</span>.<span class="fu">log</span>(val);
}</code></pre>
<p>The difference between this and a function expression is, that the <code>function</code> keyword is the first token in the declaration and that the <code>function</code> keyword is followed by a name (where the name has to comply with the identifier rules in JavaScript). <em>When the interpreter encouters a function declaration it creates a new local variable with the name of the function and assigns it a new function object</em>.</p>
<p>Some people use the term “function statement” when they mean “function declaration”, but there is no such thing as a function statement.</p>
<p>Function declarations are hoisted to the top of the enclosing function by the interpreter with the consequence that you can use them before they are defined. (Which shows that function declarations are not statements, since these are always executed in order). Do not take advantage of this behavior, but rather put function declarations on top of the enclosing function for improved readability.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">console</span>.<span class="fu">log</span>(theText); <span class="co">// &#39;You must use the force!&#39;</span>
<span class="kw">function</span> <span class="fu">theText</span> () { retun <span class="st">&#39;You must use the force!&#39;</span>; }</code></pre>
<p>Function declarations are not allowed inside of non-function blocks. Most implementations do allow them but behave inconsistently. Example:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">if</span> (<span class="kw">true</span>) {
    <span class="ot">console</span>.<span class="fu">log</span>(test);
    <span class="kw">function</span> <span class="fu">test</span> () {

    }
}</code></pre>
<p>will log <code>[Function: test]</code> in nodeJS but <code>&quot;test&quot; is not defined</code> in Firefox. (Firefox converts those occurrences of function declarations to function expressions, which means that <code>if (true) { function test () { } console.log(test); }</code> will output [object Function] as expected);</p>
<p>To be precise: According to the ECMAScript standard, <code>FunctionDeclaration</code> is a <code>SourceElement</code>, just like <code>Statement</code> is a <code>SourceElement</code>, but <code>FunctionDeclaration</code> is not a <code>Statement</code>. A <code>Block</code> can only contain <code>Statement</code> tokens, while <code>Program</code> and <code>FunctionBody</code> can contain <code>SourceElement</code> tokens include <code>FunctionDeclaration</code>.</p>
<p>Do not use function declarations inside of non-function blocks like <code>if</code> statements or loops or other non-function blocks!</p>
<h3 id="what-to-use">What to use?</h3>
<p>The Function constructor approach may be the closest to JavaScript’s internal workings, but it is rather unintuitive to write, has the worst performance and most of all: It does create scope. The function declaration has no real benefit and is actually a bit irritating because it is semantically different from a function expression without looking any different. Therefore, you should be only using function expressions. (They are also the fastest alternative according to this <a href="http://jsperf.com/function-declaration-vs-function-expression2/4">jsperf test</a>).</p>
<h3 id="examples">Examples</h3>
<p>I want to illustrate the difference between the function expression and the function declaration with an example.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="fu">add</span> (x, y) {
    <span class="kw">return</span> x+y;
}</code></pre>
<p>This function declaration does basically the same like the following function expression:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> add = <span class="kw">function</span> (x, y) {
    <span class="kw">return</span> x+y;
};</code></pre>
<p>The function statement creates a local variable with its name and assigns it a function. The only difference is, that the function defined with a declaration can be used before its appearance in the source code.</p>
<p>The following will produce a <code>SyntaxError</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> (x, y) {
    <span class="kw">return</span> x+y;
}</code></pre>
<p>because the interpreter assumes a function declaration, which has to have a name.</p>
<p>The following will not produce a <code>SyntaxError</code>, but if you try to access <code>add</code> afterwards, you will get a <code>ReferenceError</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">(<span class="kw">function</span> <span class="fu">add</span> (x, y) {
    <span class="kw">return</span> x+y;
})</code></pre>
<p>That is because the parentheses make the compiler believe that it is dealing with a function expression. And the name you give a function in a function expression is not automatically used as a variable name for the function.</p>
<h3 id="immediately-invoked-function-expressions-iife">Immediately Invoked Function Expressions (IIFE)</h3>
<p>On a side note, the following pattern should be mentioned:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">(<span class="kw">function</span> () {
    <span class="ot">console</span>.<span class="fu">log</span>(<span class="st">&#39;ready!&#39;</span>);
    <span class="co">// ...or whatsoever</span>
}());</code></pre>
<p>This is called a immediately invoked function expression, but it is often referred as a self-invoking function or self-executing function, which is wrong. It is a function expression (indicated by the outer parentheses) directly followed by an empty pair of parentheses. When the interpreter evaluates the function expression he replaces it with a function value. That way it is syntactically legal to append the pair of parentheses to it, that are indicating to the interpreter to invoke the function. (More on function invocation in <a href="#04.02.00">the next subchapter</a>).</p>
<p>It is recommended to use the outer parentheses even in places, where the function expression could not be confused with a function declaration, because they make for better readability. So instead of</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> res = <span class="kw">function</span> () { 
    <span class="ot">console</span>.<span class="fu">log</span>(<span class="st">&#39;ready!&#39;</span>);
    <span class="co">// ...or whatsoever</span>
}();</code></pre>
<p>use</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> res = (<span class="kw">function</span> () {
    <span class="ot">console</span>.<span class="fu">log</span>(<span class="st">&#39;ready!&#39;</span>);
    <span class="co">// ...or whatsoever</span>
}());</code></pre>
<p>While syntactically and semantically correct, omitting those parentheses easily leads to confusion about the intention of the code. The first one looks more like a function definition, while you quickly get used to recognizing the second as an IIFE.</p>
<p>(It does not matter, whether you put the closing parenthesis that matches the one in front of the <code>function</code> keyword before or after the invocation parentheses, but choose a style and stick with it.)</p>
<h2 id="invocation">Invocation</h2>
<p>Invoking a function means stepping out of the execution order of the current function and entering the execution of the invoked function. Additionally, variables can be bound to function parameters. A function is invoked by an invocation expression. That is an expression that, when evaluated will call the function. There are four invocation expressions.</p>
<p>They all have in common that they use a pair of parentheses to indicate the function invocation. Inside these parentheses can be a comma-seperated list of values that are passed to the function invocation. It does not matter whether the number of arguments passed matches the number of formal parameters of the function. In JavaScript there is no way to require function parameters to have certain types. Basically you can pass a function anything you want and you will never get an error from the interpreter.</p>
<h3 id="special-variables">Special variables</h3>
<p>To understand the difference between them, it is important to realize, that besides the parameters, that are explicitly passed to the function in the invocation expression, two special variables are available inside every function: <code>this</code> and <code>arguments</code>.</p>
<p><code>arguments</code> is an array-like object that contains a list of all values, passed to the function, when invoked. This is completely independent of what parameters are mentioned in the function definition. (More on <code>arguments</code> in <a href="#04.04.01">04.04.01</a>)</p>
<p><code>this</code> is a variable containing a reference to the object the function is concerned with. Calling a method on an object for example lets the method’s <code>this</code> be that object. The binding of <code>this</code> does not happen at compile time nor at the time a function is defined. The binding happens, when the function is executed. The following invocation expression are different in the way they bind <code>this</code>.</p>
<h3 id="method-invocation">Method invocation</h3>
<p>When a function is a member of an object, it is usually called a method. A method is called by appending a pair of parentheses to a qualified function value.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">obj</span>.<span class="fu">func</span>();
obj[<span class="st">&#39;func&#39;</span>]();</code></pre>
<p>If the function does not use <code>this</code>, then it might not matter that it was called like this. But when it does, <code>this</code> is bound to the object, on which the method is called on; meaning the object whose property the function is. This way a function can access its parent object and all of its other properties.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> cantina = {
    <span class="dt">location </span>: <span class="st">&#39;Mos Eisley&#39;</span>,
    <span class="dt">where </span>: <span class="kw">function</span> () { <span class="kw">return</span> <span class="st">&#39;The Cantina is in &#39;</span> + <span class="kw">this</span>.<span class="fu">location</span>; }
};
<span class="ot">cantina</span>.<span class="fu">where</span>(); <span class="co">// &#39;The Cantina in Mos Eisley&#39;</span></code></pre>
<p>Of course, methods can not only read but also write properties of their <code>this</code>.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> status = {
    <span class="dt">message </span>: <span class="st">&#39;I am not quite ready yet&#39;</span>,
    <span class="dt">getMessage </span>: <span class="kw">function</span> () {
        <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">message</span>;
    },
    <span class="dt">setMessage </span>: <span class="kw">function</span> (update) {
        <span class="kw">this</span>.<span class="fu">message</span> = update;
    }
};
<span class="ot">status</span>.<span class="fu">setMessage</span>(<span class="st">&#39;Let</span><span class="ch">\&#39;</span><span class="st">s go!&#39;</span>);
<span class="ot">status</span>.<span class="fu">getMessage</span>(); <span class="co">// &#39;Let\&#39;s go!&#39;</span>
<span class="fu">getMessage</span>(); <span class="co">// ReferenceError: getMessage is not defined</span></code></pre>
<p>Keep in mind that the <code>this</code> object does not necessarily have to be an object containing the function. Soon we will learn ways to bind any object to any function so liberate yourself from the sense that their is a very special relationship between objects and their methods.</p>
<h3 id="function-invocation">Function invocation</h3>
<p>If a function does not concern itself with a certain object or is not even a member property of one, it might aswell be invoked as a simple function. The identifier that resolves to the function value will not contain any refinements in such cases.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> func = <span class="kw">function</span> () {
    <span class="ot">console</span>.<span class="fu">log</span>(<span class="st">&#39;Invocation successful&#39;</span>);
};
<span class="fu">func</span>(); <span class="co">// &#39;Invocation successful&#39;</span></code></pre>
<p>Unfortunately, in most implementations of the language, function invocation makes <code>this</code> be bound to the global object. In web browsers that is the <code>window</code> object.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> getGlobal = <span class="kw">function</span> () {
    <span class="kw">return</span> <span class="kw">this</span>;
};
<span class="fu">getGlobal</span>() === window; <span class="co">// true</span></code></pre>
<p>This is almost always unintended behavior. You would also expect, that scoping applies to <code>this</code>, but it does not, which means that an outer functions <code>this</code> is not visible inside an inner function.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> obj = {
    <span class="dt">outer </span>: <span class="kw">function</span> () {
        <span class="ot">console</span>.<span class="fu">log</span>(<span class="kw">this</span> === obj);
        <span class="kw">var</span> inner = <span class="kw">function</span> () {
            <span class="ot">console</span>.<span class="fu">log</span>(<span class="kw">this</span> === window);
        };
        <span class="fu">inner</span>(); <span class="co">// true</span>
    }
};
<span class="ot">obj</span>.<span class="fu">outer</span>(); <span class="co">// true</span></code></pre>
<p>The interpreter binds an individual value to every function invocation even if that value does not make sense. Because the implicit binding of the global object to <code>this</code> it is very easy to accidentally add properties to the global object. This is generally not good and especially when unintended. In ES5 strict mode, <code>this</code> is bound to the <code>undefined</code> value in functions that are being invoked via function invocation. This is not great, but better than the previous solution. (More on strict mode in XX.XX).</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> getUndef = <span class="kw">function</span> () {
    <span class="st">&#39;use strict&#39;</span>;
    <span class="kw">return</span> <span class="kw">this</span>;
};
<span class="fu">getUndef</span>() === <span class="kw">undefined</span>; <span class="co">// true</span></code></pre>
<h3 id="constructor-invocation">Constructor invocation</h3>
<p>This invocation mechanism makes use of the <code>new</code> keyword. If a method invocation or function invocation is prefixed with <code>new</code>, that tells the compiler to treat the function being called as a constructor. What constructors really are will be our topic very soon, but let’s look at how they are called. All you need to know now is that constructors are functions. They are not inherently special but become special because of the way they are invoked: Using <code>new</code>.</p>
<p>The <code>new</code> operator does some magic, but step-by-step we will uncover its secrets. There are mainly three things, <code>new</code> does: 1. Creating a new object, 2. calling the function that <code>new</code> is used with, binding the function’s <code>this</code> to the new object and 3. returning the object (unless the constructor has its own return value). Let’s see that in action!</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> Spacestation = <span class="kw">function</span> (name) {
    <span class="kw">this</span>.<span class="fu">name</span> = name;
};
<span class="kw">var</span> deathstar = <span class="kw">new</span> <span class="fu">Spacestation</span>(<span class="st">&#39;Death Star&#39;</span>);
<span class="ot">console</span>.<span class="fu">log</span>(deathstar); <span class="co">// { name : &#39;Death Star&#39; }</span></code></pre>
<p>The constructor invocation returned an object that has the property that was assigned to it from inside the function. In future chapters we will be talking a lot about constructors. What you need to understand is, that they are just functions. If the <code>new</code> keyword irritates you, you could write a function to replace the <code>new</code> keyword; a very simple version would look somewhat like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> construct = <span class="kw">function</span> (fn) {
    <span class="kw">var</span> that = { };
    <span class="ot">fn</span>.<span class="fu">apply</span>(that);
    <span class="kw">return</span> that;
};</code></pre>
<p>It takes a constructor function as an argument, creates a new object, calls the function, binding the object to the function’s <code>this</code> and returns the new object. This function is simplified and we will enhance it to be capable of dealing with inheritance in <a href="#04.07.01">chapter 04.07</a>. For now it would be great if it could accept additional parameters and pass them on to the constructor function.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> construct = <span class="kw">function</span> (fn) {
    <span class="kw">var</span> args = <span class="ot">Array</span>.<span class="ot">prototype</span>.<span class="ot">slice</span>.<span class="fu">call</span>(arguments, <span class="dv">1</span>),
        that = { };
    <span class="ot">fn</span>.<span class="fu">apply</span>(that, args);
    <span class="kw">return</span> that;
};</code></pre>
<p>This <code>construct</code> function passes every additional argument it receives on to the actual constructor function. Don’t worry if that “Array” things looks cryptic: You will get to know it in one of the next subchapters. Let’s use our newly created helper function.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> Spacestation = <span class="kw">function</span> (name) {
    <span class="kw">this</span>.<span class="fu">name</span> = name;
};
<span class="kw">var</span> deathstar = <span class="fu">construct</span>(ConstructionService, <span class="st">&#39;Death Star&#39;</span>);
<span class="ot">console</span>.<span class="fu">log</span>(o); <span class="co">// { name : &#39;Death Star&#39; }</span></code></pre>
<p>Using functions that expect to be called via constructor invocation has a serious drawback: When you omit the <code>new</code>, when calling such a function that was intended to be used as a constructor, it might fail to return a new object. It relies on the <code>new</code> keyword to create an object for it and if that is left out, there will be no object. Even worse: Remember that when a function is called without an object to be concerned with, <code>this</code> is bound to the global object. Constructors usually add properties to <code>this</code> so these will end up becoming global variables inside your program. You do not want that.</p>
<p>It is a common convention (not just in JavaScript) to start the name of a constructor function with a capital letter and to not use capital letters at the beginning of any other variable name.</p>
<p>Another issue with the <code>new</code> operator is, that it obscures JavaScript’s nature and disguises it as being a classical language. But since JavaScript does not use classical inheritance, related programming patterns may not be adequate. More on inheritance in <a href="#05.00.00">chapter 5</a>. While looking familiar to programmers, coming from classical languages like Java, the <code>new</code> prefix is likely to be the source of confusion. In the following I will not use <code>new</code> anymore but our <code>construct</code> function from above. We will see an advanced version of <code>construct</code> that does exactly the same as the <code>new</code> prefix does and in examining the <code>construct</code> function you can see, what <code>new</code> does under the hood.</p>
<h3 id="callapply-invocation">Call/Apply Invocation</h3>
<p>The fourth invocation expression for functions is maybe less commonly used but offers a great deal of flexibility. Inheriting from <code>Function.prototype</code>, every function has an <code>apply</code>- and a <code>call</code>-method (remember that functions are objects and can have their own methods). These allow you to explicitly specify the value of <code>this</code>.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> cantina = {
    <span class="dt">location </span>: <span class="st">&#39;Mos Eisley&#39;</span>
};
<span class="kw">var</span> where = <span class="kw">function</span> () { <span class="kw">return</span> <span class="st">&#39;The Cantina is in &#39;</span> + <span class="kw">this</span>.<span class="fu">location</span>; };
<span class="ot">cantina</span>.<span class="fu">where</span>(); <span class="co">// TypeError: cantina.where is not a function</span>
<span class="ot">where</span>.<span class="fu">apply</span>(cantina); <span class="co">// &#39;The Cantina in Mos Eisley&#39;</span>
<span class="ot">where</span>.<span class="fu">call</span>(cantina); <span class="co">// &#39;The Cantina in Mos Eisley&#39;</span></code></pre>
<p>The function <code>where</code> is invoked with <code>cantina</code> as <code>this</code>. So while the <code>where</code> function is defined completely independent of any object, it can access one as <code>this</code> when called with the <code>call</code> or <code>apply</code> method. These methods illustrate the late binding of <code>this</code>, happening not until the function is executed.</p>
<p>The difference between <code>call</code> and <code>apply</code> is the way in which they receive arguments. <code>apply</code> expects exactly two arguments: The object to be bound to <code>this</code> and an array with values to be passed as arguments to the function. <code>call</code> expects an arbitrary number of elements, of which the first is being bound to <code>this</code> and the rest is being passed as arguments to the function.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> spacestation = <span class="kw">function</span> (name, system) {
    <span class="kw">this</span>.<span class="fu">name</span> = name;
    <span class="kw">this</span>.<span class="fu">system</span> = system;
};
<span class="kw">var</span> yavin = <span class="ot">spacestation</span>.<span class="fu">apply</span>({}, [<span class="st">&#39;Yavin Station&#39;</span>, <span class="st">&#39;Yavin System&#39;</span>]);
<span class="kw">var</span> forge = <span class="ot">spacestation</span>.<span class="fu">call</span>({}, <span class="st">&#39;Star Forge&#39;</span>, <span class="st">&#39;Lehon System&#39;</span>);</code></pre>
<h3 id="binding-this">Binding <code>this</code></h3>
<p>In some cases, the automatic binding of <code>this</code> is not what you want. You control the binding by using <code>call</code>/<code>apply</code>. Consider the following example:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> Person1 = {
    <span class="dt">name </span>: <span class="st">&#39;Bob&#39;</span>,
    <span class="dt">getName </span>: <span class="kw">function</span> () { <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">name</span> }
};

<span class="kw">var</span> Person2 = {
    <span class="dt">name </span>: <span class="st">&#39;Alice&#39;</span>
};</code></pre>
<p>Alice has no <code>getName</code> method, but we can use the one, Bob has, to return Alice’s name. Therefore, we use <code>apply</code> to bind <code>Person2</code> to <code>getName</code>’s <code>this</code> property:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">Person1</span>.<span class="ot">getName</span>.<span class="fu">apply</span>(Person2); <span class="co">// &#39;Alice&#39;</span></code></pre>
<p>The automatic binding of <code>this</code> is a serious pitfall for people, new to JavaScript, (and more often than not even for experienced JavaScripters). Special care has to be taken, when passing around callbacks and attaching those to event handlers.</p>
<p>Another way to control the binding of <code>this</code> is by using the <code>Function.prototype</code>’s <code>bind</code> property. Calling <code>bind</code> on a function returns a new function, that, when executed, uses the first argument that was passed to the <code>bind</code> call, as <code>this</code>. An alternate solution to the previous example would then look like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> getPerson2sName = <span class="ot">Person1</span>.<span class="ot">getName</span>.<span class="fu">bind</span>(Person2);
<span class="fu">getPerson2sName</span>(); <span class="co">// &#39;Alice&#39;</span></code></pre>
<p>We created a new function, that returns the <code>name</code> property of the <code>Person2</code> object. You could write <code>bind</code> yourself, if you wanted to.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">Function</span>.<span class="ot">prototype</span>.<span class="fu">binding</span> = <span class="kw">function</span> (obj) {
    <span class="kw">var</span> args0 = <span class="ot">Array</span>.<span class="ot">prototype</span>.<span class="ot">slice</span>.<span class="fu">call</span>(arguments, <span class="dv">1</span>),
        def = <span class="kw">this</span>;
    <span class="kw">return</span> <span class="kw">function</span> () {
        <span class="kw">return</span> <span class="ot">def</span>.<span class="fu">apply</span>(obj, <span class="ot">args0</span>.<span class="fu">concat</span>(<span class="ot">Array</span>.<span class="ot">prototype</span>.<span class="ot">slice</span>.<span class="fu">call</span>(arguments)));
    };
};</code></pre>
<h2 id="scope">Scope</h2>
<p>The concept of scope describes the visibility of variables in a program. Whether a function can access a certain variable is a question of scope. Think of a scope as a container in which variables reside. The general rule is that variables cannot be accessed from outside this container but from everywhere inside. Scopes can be nested.</p>
<h3 id="function-scope">Function scope</h3>
<p>Many languages implement what is called block scope, where a new scope is induced by a block such as a class, a function or an if statement. In JavaScript there is function scope hence the only way to create a new scope is by defining a function. This is really simple: A variable that gets declared inside a function is visible inside of that function but not outside of it.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> f = <span class="kw">function</span> () {
    <span class="kw">var</span> iam = <span class="st">&#39;batman&#39;</span>;
    <span class="ot">console</span>.<span class="fu">log</span>(iam);
};
<span class="fu">f</span>(); <span class="co">// &#39;batman&#39;</span>
<span class="ot">console</span>.<span class="fu">log</span>(iam); <span class="co">// ReferenceError: iam is not defined</span></code></pre>
<p>The function <code>f</code> has its own scope in which <code>iam</code> is declared. This variable is visible inside the <code>f</code> function but not on the outside. But what is the scope in which <code>f</code> is declared?</p>
<h3 id="global-scope">Global scope</h3>
<p>I already mentioned that scopes can be nested. There is one scope on top of the scope hierarchy and that is the global scope. I also already talked about the global object and basically there is not much of a difference. Any variable declaration that is not happening inside of a function adds a variable to the global scope as well as a property to the global object.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> a = <span class="st">&#39;a&#39;</span>;
b = <span class="st">&#39;b&#39;</span>;
<span class="ot">window</span>.<span class="fu">c</span> = <span class="st">&#39;c&#39;</span>;

<span class="ot">console</span>.<span class="fu">log</span>(<span class="ot">window</span>.<span class="fu">a</span>); <span class="co">// &#39;a&#39;</span>
<span class="ot">console</span>.<span class="fu">log</span>(<span class="ot">window</span>.<span class="fu">b</span>); <span class="co">// &#39;b&#39;</span>
<span class="ot">console</span>.<span class="fu">log</span>(c); <span class="co">// &#39;c&#39;</span></code></pre>
<p>Notice that <code>window</code> is the name of the global object in web browsers; in nodejs the global object can be referred to as <code>root</code> or <code>GLOBAL</code>. Cluttering the global scope is not recommended. Especially when your applications grow larger or your code runs alongside third party code, it is a serious issue that name collisions of variables can occur. There is no error when you accidentally write to a global variable so you have to be cautious all the time.</p>
<p>Like many other popular languages, JavaScript uses lexical scoping, meaning, that scope inheritance is statically defined. Everything inside a function that is nested inside of another function has access not only the scope of the inner one but also the one of the outer one.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> f0 = <span class="kw">function</span> () {
    <span class="kw">var</span> val0 = <span class="dv">1</span>;
    <span class="kw">var</span> f1 = <span class="kw">function</span> () {
        <span class="ot">console</span>.<span class="fu">log</span>(val0); <span class="co">// 1</span>
    };
};</code></pre>
<p>Here, f1 has access to all variables, declared inside of f0. Notice that a function’s scope contains <em>references</em> to and not the values of variables from its lexical environment.</p>
<p>When the inner of two nested functions declares a variable, that has the same name as one, defined in the outer function, the new value of that variable will be attached to the scope of the function that it was declared in. The consequence being, that everywhere inside the inner function, the variable will now have a different value. This is called shadowing.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> f0 = <span class="kw">function</span> () {
    <span class="kw">var</span> val0 = <span class="dv">1</span>;
    <span class="kw">var</span> f1 = <span class="kw">function</span> () {
        <span class="kw">var</span> val0 = <span class="st">&#39;Shadow&#39;</span>;
        <span class="ot">console</span>.<span class="fu">log</span>(val0); <span class="co">// &#39;Shadow&#39;</span>
    };
    <span class="ot">console</span>.<span class="fu">log</span>(val0); <span class="co">// 1</span>
};</code></pre>
<p>A different approach to scoping would be dynamic scoping, where a function inherits the scope of the function that calls it. That makes for less maintainable code and we are lucky to have lexical scoping in JavaScript.</p>
<p>But function scope only applies to variables defined with a variable declaration, so let us revisit the ways to define a variable.</p>
<ul>
<li><p>Variable Declaration This is the most important one and it was already defined in <a href="#XX.XX">XX.XX</a>. As mentioned above, variables defined via variable declaration obey the rules of function scope.</p></li>
<li><p>Variable Assignment Assigning a value to a variable that was not previously declared with <code>var</code>, results in the initialization of a new global variable with the given value. Global variables are visible in every scope.</p></li>
<li><p>Variable Declaration with <code>let</code> Introduced in <a href="#XX.XX">XX.XX</a>, the <code>let</code> keyword works similar to <code>var</code> but creates a variable with block scope.</p></li>
</ul>
<p>Since <code>let</code> is new in ES6, which is neither fully specified nor sufficiently implemented, using <code>let</code> is not safe yet.</p>
<p>The use of global variables is generally to be kept to a minimum. If you are writing web applications, your code will run in the same global scope as any libraries you include or any code that gets loaded on the same page. You should therefore try to use as few global variables (if any) as possible. You should strictly modularize your code.</p>
<h3 id="modules">Modules</h3>
<p>There is no built-in module functionality in JavaScript. But you can avoid scattering the global scope and protect your module’s variables by enclosing a module within a immediately executed function (as introduced in <a href="#04.01.06">04.01.06</a>):</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> myModule = (<span class="kw">function</span> () {
    <span class="kw">return</span> {
        <span class="dt">f0 </span>: <span class="kw">function</span> () { ... },
        <span class="dt">f1 </span>: ...
    };
}());</code></pre>
<p>The module simply returns an object, containing all the properties and methods that you want to export. Any other code can then access them like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">myModule</span>.<span class="fu">f0</span>();</code></pre>
<p>It is even possible and generally recommended to wrap the whole program in such a function. If that gets loaded and executed in a web page context, variable scope guarantees, that there are no conflicts with any other code, running on the same page.</p>
<h3 id="special-variables-1">Special variables</h3>
<p>There are two variables, that are not affected by the rules of scope: <code>arguments</code> and <code>this</code>. These are initialized for every function each time it is called. More on <code>arguments</code> in <a href="#04.04.01">04.04.01</a> and more on <code>this</code> in <a href="#04.02.00">04.02</a>. Sometimes, you have nested functions where you want an inner function to have access to the object, pointed to by the <code>this</code> of the outer function. Since the inner function always gets its own <code>this</code>, you have to declare a new variable for that object. This variable is conventionally called <code>that</code>.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> f0 = <span class="kw">function</span> () {
    <span class="kw">var</span> that = <span class="kw">this</span>;
    <span class="kw">var</span> helper = <span class="kw">function</span> () {
        <span class="kw">var</span> a = <span class="ot">that</span>.<span class="fu">getA</span>();
    };
};</code></pre>
<h2 id="arguments">Arguments</h2>
<p>Let us now look at the way functions can receive arguments. Arguments that are passed to a function call are bound to local variables of the function execution context (scope). If a function is called, with too many arguments, the additional arguments are ignored. If a function is called, with too few arguments, the left-out parameters are initialized with <code>undefined</code>. In both cases there is no error that gets thrown or anything like that.</p>
<p>Since there are (especially in newer versions of the language specification) some creative ways for parameter definitions, they deserve their own sub-chapter.</p>
<p>One important thing to remember is, that primitives are always call-by-value and objects are always call-by-reference.</p>
<h3 id="arguments-1"><code>arguments</code></h3>
<p><code>arguments</code> is an array-like object containing all values, that were passed to the function invocation. It is unrelated to the number of parameters defined in the function definition and thus makes it possible to write function that take an arbitrary number of arguments like the following:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> add = <span class="kw">function</span> () {
    <span class="kw">var</span> i = <span class="dv">0</span>, l = <span class="ot">arguments</span>.<span class="fu">length</span>, total = <span class="dv">0</span>;
    <span class="kw">for</span> (; i &lt; l; i += <span class="dv">1</span>) {
        total += arguments[i];
    }
    <span class="kw">return</span> total;
};</code></pre>
<p>Sadly, <code>arguments</code> is not an array. The only things it has in common with arrays is that its property names are integers starting from 0, and that it has a <code>length</code> property. In constrast to real arrays this <code>length</code> property is not magic in that changing it does not affect the contents of the <code>arguments</code> object. <code>arguments</code> inherits none of the array methods, that <code>Array.prototype</code> provides so these methods have to be called on <code>arguments</code> with <code>call</code>/<code>apply</code>. In cases where you want <code>arguments</code> to be a real array, you can convert it to one by using array methods. The common way to do the conversion is by something like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> args = <span class="ot">Array</span>.<span class="ot">prototype</span>.<span class="ot">slice</span>.<span class="fu">apply</span>(arguments);</code></pre>
<p><code>slice</code> returns an array and since it was invoked with <code>arguments</code> as <code>this</code> but without any parameters, it does not alter the original data structure.</p>
<p>The values in the <code>arguments</code> object are coupled with the function’s local parameter values. Changing a property on the <code>arguments</code> object affects the local variable it is tied to.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">(<span class="kw">function</span> (a) {

    <span class="ot">console</span>.<span class="fu">log</span>(a);

    arguments[<span class="dv">0</span>] = <span class="st">&#39;Batman&#39;</span>;
    <span class="ot">console</span>.<span class="fu">log</span>(a);

    a = <span class="st">&#39;Green Lantern&#39;</span>;
    <span class="ot">console</span>.<span class="fu">log</span>(arguments[<span class="dv">0</span>]);

}(<span class="st">&#39;Captain America&#39;</span>));

<span class="co">// &#39;Captain America&#39;</span>
<span class="co">// &#39;Batman&#39;</span>
<span class="co">// &#39;Green Lantern&#39;</span></code></pre>
<p>This binding does not work for parameters that were not passed to the function call (some older versions of Chrome did create the binding in those cases too, but that was not standard-compliant and got fixed). The coupling is only valid for parameters that were actually passed to the function.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">(<span class="kw">function</span> (a) {

    <span class="ot">console</span>.<span class="fu">log</span>(a);

    arguments[<span class="dv">0</span>] = <span class="st">&#39;Batman&#39;</span>;
    <span class="ot">console</span>.<span class="fu">log</span>(a);

}());

<span class="co">// undefined</span>
<span class="co">// undefined</span></code></pre>
<p>The <code>arguments</code> object also has a property called <code>callee</code>. This property points to the function that the <code>arguments</code> object belongs to. This property was introduced to the language in order to enable anonymous functions to call themselves recursively. There once were no named function expressions in JavaScript which is why <code>arguments.callee</code> was necessary. It is no longer and its use is deprecated. In ES5 strict mode <code>arguments.callee</code> is forbidden.</p>
<p>Another deprecated property is <code>arguments.caller</code> which points to the function, the current function was called from. In current brwoser versions this no longer works so you can ignore that this feature once existed.</p>
<p>NOTICE: This <code>arguments</code> variable is not the same as <code>Function.prototype.arguments</code>. The later will mostly do the same, but its use is deprecated.</p>
<p>Chances are, the <code>arguments</code> object will eventually be replaced by something better. The object will sure be around for a long time (for compatability reasons), but so called “rest parameters” offer more convenience.</p>
<h3 id="default-parameters">Default Parameters</h3>
<p>As of ES5.1 there is no syntax for default parameter values, but the logical OR operator <code>||</code> can be used to write short default assignments.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">(<span class="kw">function</span> (obj) {
    <span class="kw">var</span> o = obj || {};
    <span class="ot">o</span>.<span class="fu">solve</span> = <span class="kw">function</span> () { };
    <span class="kw">return</span> o;
}());</code></pre>
<p>The above function adds a <code>solve</code> function to a given object. If no object is supplied to the function invocation a new one is created. If no argument is given to the function call, <code>obj</code> is <code>undefined</code> which is a falsy value. Because of that the <code>||</code> operator returns the result of evaluating the right hand side expression. This works just fine, but in ES6 there will be a builtin syntax for default parameters. The above would then be written as:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">(<span class="kw">function</span> (obj = {}) {
    <span class="ot">obj</span>.<span class="fu">solve</span> = <span class="kw">function</span> () { };
    <span class="kw">return</span> obj;
}());</code></pre>
<h3 id="bonus-rest-parameter-es6">BONUS: Rest Parameter (ES6)</h3>
<p>The current draft of ES6 proposes an alternative to <code>arguments</code> for dealing with indefinite number of arguments. The last parameter of a function in a function definition can be written with a prefix of three dots <code>...args</code> designating it as an array that contains all additional parameters that were passed to the function.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">(<span class="kw">function</span> (a, b, ...<span class="fu">rest</span>) {
    <span class="ot">console</span>.<span class="fu">log</span>(<span class="ot">rest</span>.<span class="fu">map</span>(<span class="kw">function</span> (val) {
        <span class="kw">return</span> val * <span class="dv">10</span>;
    }));
}(<span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">6</span>));

<span class="co">// [70, 60]</span></code></pre>
<p>At the time of writing, the above code will only work in Firefox (according to kangax also in IE10+ but that does not seem to work), but as more ES6 features are implemented, rest parameters are likely to find their way into all implementations.</p>
<h3 id="bonus-destructuring">BONUS: Destructuring</h3>
<h2 id="closure">Closure</h2>
<p>Along with prototypal inheritance, closure is the most one of the most important concepts in JavaScript. It is easy to learn and very powerful. It allows JavaScript to be written in a very expressive way and to utilize it to facilitate a flexible programming approach as well as to build creative patterns.</p>
<p>A major aspect of closures is lexical scoping, which we have already covered in <a href="#04.03.00">04.03</a>. Lexical scoping is the reason, that in the following code</p>
<pre><code>var f0 = function () {
    var priv = &#39;my secret&#39;;
    return helper = function () {
        ...
    };
};</code></pre>
<p>the function <code>helper</code> has access to the variable <code>priv</code>. But what happens, when <code>priv</code> is altered during runtime, or when <code>f0</code> has returned?</p>
<p>Closure means, that, when a function is invoked, it gets a reference to its lexical environment. As a consequence, a function will always have access to all the variables that were accessible in the scope in which the function was declared.</p>
<p>Example:</p>
<pre><code>var counter = (function () {
    var count = 0;
    return {
        get : function () {
            return count;
        },
        incr : function () {
            count = count + 1;
        }
    };
}());</code></pre>
<p>We create an object, that can increment a counter and return the current counter value. The <code>counter</code> variable is assigned the result of calling an anonymous function, that declares a local variable <code>count</code> and returns an object with two methods. Because of closure, these have (and will always have) access to the <code>count</code> variable. While the anonymous function immediately returns, its local variables are not destroyed.</p>
<p>This example leads to the question, whether there is a new <code>count</code> variable, everytime that anonymous function would be called, or whether all of the objects returned, share the same <code>count</code> variable. In order to investigate, let us rewrite the previous code.</p>
<pre><code>var makeCounter = function () {
    var count = 0;
    return {
        getCount : function () {
            return count;
        },
        incr : function () {
            count = count + 1;
        }
    };
};

var counterA = makeCounter();
var counterB = makeCounter();

counterA.incr();

counterA.getCount(); // 1
counterB.getCount(); // 0</code></pre>
<p>Every time <code>makeCounter</code> is called, a new execution context is created and thus a new count variable, which is visible to everything, defined in that same execution context, but nowhere outside of it including different executions of the <code>makeCounter</code> function.</p>
<p>SEALER/UNSEALER EXAMPLE</p>
<h3 id="memoization">Memoization</h3>
<p>We can use closure, to speed up algorithms significantly. Take the Fibonacci numbers for example. Tradionally you would write an algorithm, computing the Fibonacci number of n, in a recursive fashion.</p>
<pre><code>var fib = function (n) {
    return n &lt; 2 ? 1 : fib(n-1) + fib(n-2);
};</code></pre>
<p>While being easy to implement, this solution has the drawback of poor performance. Most of the computation time is spent, calculating the same intermediary results repeatedly. A great speedup could be achieved by simply saving all the results that have been computed so that they can be immediately returned, when they otherwise were calculated again. We can do that, by creating a closure, containing an array to put our results in and the actual formula. We create a new function, that looks up the result for a given input in the result array and only starts the actual calculation if this result has not yet been calculated. This technique is called memoization and our <code>memoize</code> function can look like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> memoize = <span class="kw">function</span> (fn) {
    <span class="kw">var</span> memo = [],
        self = <span class="kw">function</span> (x) {
            <span class="kw">if</span> (<span class="kw">typeof</span> memo[x] !== <span class="st">&#39;number&#39;</span>)  {
                memo[x] = <span class="fu">fn</span>(self, x);
            }
            <span class="kw">return</span> memo[x];
        };
    <span class="kw">return</span> self;
};

<span class="kw">var</span> memoizedFib = <span class="fu">memoize</span>(<span class="kw">function</span> (fib, n) {
    <span class="kw">return</span> n &lt; <span class="dv">2</span> ? <span class="dv">1</span> : <span class="fu">fib</span>(n<span class="dv">-1</span>) + <span class="fu">fib</span>(n<span class="dv">-2</span>);
});</code></pre>
<h2 id="currying-and-partials">Currying and Partials</h2>
<p>Currying describes a technique to divide work into multiple function executions and step by step handing in more function parameters. That way, a function that maps (x, y) -&gt; (n) can be written as a curry function that maps (x -&gt; (x, y) -&gt; n). We transform a function with multiple arguments into a chain of functions, each taking only one argument.</p>
<p>For example, a simple add function would look like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> add = <span class="kw">function</span> (x, y) {
    <span class="kw">return</span> x + y;
};</code></pre>
<p>But if we curry that function, we can use it to create adders that each add a constant amount to their argument parameter.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> makeAdder = <span class="kw">function</span> (x) {
    <span class="kw">return</span> <span class="kw">function</span> (y) {
        <span class="kw">return</span> x + y;
    };
};
<span class="kw">var</span> add1 = <span class="fu">makeAdder</span>(<span class="dv">1</span>);
<span class="kw">var</span> add7 = <span class="fu">makeAdder</span>(<span class="dv">7</span>);

<span class="ot">console</span>.<span class="fu">log</span>(<span class="fu">add1</span>(<span class="dv">9</span>)); <span class="co">// 10</span>
<span class="ot">console</span>.<span class="fu">log</span>(<span class="fu">add7</span>(<span class="dv">8</span>)); <span class="co">// 15</span></code></pre>
<p>The greatest benefit of currying is probably improved mainanability. A function that takes just one argument is much easier to reason about. Simplifying functions is a good thing, as bugs hide in complexity, and larger functions are harder to read, harder to memorize and harder to debug. Currying is a great feature of functional programming languages and JavaScript has the virtue of incorporating the functional paradigm as well as the object oriented and procedural style.</p>
<p>We can write an abstract function to transform a function into a curried version of itself.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">Function</span>.<span class="ot">prototype</span>.<span class="fu">curry</span> = <span class="kw">function</span> () {
    <span class="kw">var</span> args0 = <span class="ot">Array</span>.<span class="ot">prototype</span>.<span class="ot">slice</span>.<span class="fu">call</span>(arguments),
        fn = <span class="kw">this</span>;
    <span class="kw">return</span> <span class="kw">function</span> () {
        <span class="kw">return</span> <span class="ot">fn</span>.<span class="fu">apply</span>(<span class="kw">this</span>, <span class="ot">args0</span>.<span class="fu">concat</span>(<span class="ot">Array</span>.<span class="ot">prototype</span>.<span class="ot">slice</span>.<span class="fu">call</span>(arguments)));
    };
};</code></pre>
<p><code>Function.prototype.curry</code> can be called on another function, taking some arguments and returning a new function. When this new function is called, it receives the arguments from the curry call before and any parameters that are given to the current call. Let’s see our new curry wrapper in action.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> add = <span class="kw">function</span> (x, y) {
    <span class="kw">return</span> x + y;
};

<span class="kw">var</span> add1 = <span class="ot">add</span>.<span class="fu">curry</span>(<span class="dv">1</span>);
<span class="kw">var</span> add7 = <span class="ot">add</span>.<span class="fu">curry</span>(<span class="dv">7</span>);

<span class="ot">console</span>.<span class="fu">log</span>(<span class="fu">add1</span>(<span class="dv">9</span>)); <span class="co">// 10</span>
<span class="ot">console</span>.<span class="fu">log</span>(<span class="fu">add7</span>(<span class="dv">8</span>)); <span class="co">// 15</span></code></pre>
<p>Note that the <code>add</code> function’s definition is completely agnostic of the fact that it gets curried. If you would give more parameters to either the curry call or the actual function call, those extra parameters would be ignored.</p>
<h3 id="partials">Partials</h3>
<p>Another feature of curried functions is, that you can partially apply them. That means, that you provide as many arguments as you can and hand in the rest later.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> addXYZ = <span class="kw">function</span> (x) {
    <span class="kw">return</span> <span class="kw">function</span> (y) {
        <span class="kw">return</span> <span class="kw">function</span> (z) {
            <span class="kw">return</span> x + y + z;
        };
    };
};
<span class="kw">var</span> add3toYZ = <span class="fu">addXYZ</span>(<span class="dv">3</span>);
<span class="kw">var</span> add7toZ = <span class="fu">add3toYZ</span>(<span class="dv">4</span>);
<span class="kw">var</span> add8toZ = <span class="fu">addXYZ</span>(<span class="dv">2</span>)(<span class="dv">6</span>);
<span class="kw">var</span> fourteen = <span class="fu">addXYZ</span>(<span class="dv">4</span>)(<span class="dv">7</span>)(<span class="dv">3</span>);</code></pre>
<p>As soon as you have computed the first argument for a function, you can partially execute the function, saving it for later, when the other arguments are ready. But you always have the alternative of calling a curried function with all the arguments at once, if you want to.</p>
<p>You can use the <code>bind</code> method to do partial application, since it not only an object as a parameter, but also an abitrary number of arguments to pass on to the call of the new function.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> add = <span class="kw">function</span> (x, y) {
    <span class="kw">return</span> x + y;
};
<span class="kw">var</span> add1 = <span class="ot">add</span>.<span class="fu">bind</span>(<span class="kw">this</span>, <span class="dv">1</span>);</code></pre>
<h3 id="composition-1">Composition</h3>
<p>Sometimes you may want to create a function that is the composition of two other functions. That way you can have a function perform a complex task that constitutes of smaller functions solving parts of the problem. A function that composes two functions can look like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">Function</span>.<span class="ot">prototype</span>.<span class="fu">compose</span> = <span class="kw">function</span> (fn0) {
    <span class="kw">var</span> fn1 = <span class="kw">this</span>;
    <span class="kw">return</span> <span class="kw">function</span> () {
        <span class="kw">return</span> <span class="ot">fn1</span>.<span class="fu">call</span>(<span class="kw">this</span>, <span class="ot">fn0</span>.<span class="fu">apply</span>(<span class="kw">this</span>, arguments));
    };
};

<span class="kw">var</span> square = <span class="kw">function</span> (x) { <span class="kw">return</span> x * x; };
<span class="kw">var</span> double = <span class="kw">function</span> (x) { <span class="kw">return</span> <span class="dv">2</span> * x; };

<span class="kw">var</span> squareThenDouble = <span class="ot">double</span>.<span class="fu">compose</span>(square);
<span class="kw">var</span> doubleThenSquare = <span class="ot">square</span>.<span class="fu">compose</span>(double);

<span class="ot">console</span>.<span class="fu">log</span>(<span class="fu">squareThenDouble</span>(<span class="dv">3</span>)); <span class="co">// 18</span>
<span class="ot">console</span>.<span class="fu">log</span>(<span class="fu">doubleThenSquare</span>(<span class="dv">3</span>)); <span class="co">// 36</span></code></pre>
<p>In the end you don’t have to know about the parts that made up the more complex function. So while <code>squareThenDouble(X)</code> does the same as <code>double(square(X))</code> you no longer have to remember or have access to the simple functions.</p>
<h2 id="constructors">Constructors</h2>
<p>In order to write powerful patterns for object creation and inheritance, we we can use, what we learned about functions, to build constructors. JavaScript has no classes, but constructors can work similarly while providing more flexibility and expressiveness than the static constructs that classes are in languages like Java.</p>
<h3 id="definition-1">Definition</h3>
<p>First thing to mention is, that there is no type of constructor in JavaScript and basically, every function can be a constructor. We call a function a constructor, when it creates an object in some way or the other, optionally modifies the object and then returns it. Constructors are often used in conjunction with the <code>new</code> keyword, in which case the <code>new</code> operator takes care of creating an object and returning it. We will look at both ways of defining a constructor. The name capitalization convention applies not to all constructors, but those, that do not handle object creation, which includes all functions, that are meant to be called with <code>new</code>. It is possible to write functions, that take a constructor as an argument, create a new object and invoke the constructor with that object. To indicate, whether a constructor function creates its own object or not, those that don’t are assigned names with capital first letters. You can call any function as a constructor by using <code>new</code> (as previously discussed in <a href="#04.02.03">04.02.03</a>), but that does not generally makes sense.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> myConstructor = <span class="kw">function</span> () {
    <span class="kw">return</span> { };
};</code></pre>
<p>Above is a minimal constructor function that just creates a new object using the object literal and then returns that object. Inside the constructor, you build an object to your liking, adding properties and methods to it.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> person = <span class="kw">function</span> (name) {
    <span class="kw">var</span> that = { };
    <span class="ot">that</span>.<span class="fu">name</span> = name;
    <span class="ot">that</span>.<span class="fu">greet</span> = <span class="kw">function</span> () {
        <span class="kw">return</span> <span class="st">&#39;Hello, I am &#39;</span> + <span class="kw">this</span>.<span class="fu">name</span> + <span class="st">&#39;!&#39;</span>;
    };
    <span class="kw">return</span> that;
};</code></pre>
<p>The use of <code>that</code> is necessary, since <code>this</code> is a readonly variable and it also does not really matter, what our new object is called inside its constructor.</p>
<hr />
<p>In <a href="#04.02.03">04.02.03</a> I discourage the use of <code>new</code>, because it obfuscates JavaScripts internal logic. While you will encouter <code>new</code> in books and on the internet, I will replace it with the following function:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">Function</span>.<span class="ot">prototype</span>.<span class="fu">create</span> = <span class="kw">function</span> () {
    <span class="kw">var</span> that = <span class="ot">Object</span>.<span class="fu">create</span>(<span class="kw">this</span>.<span class="fu">prototype</span> || { }),
        theOther = <span class="kw">this</span>.<span class="fu">apply</span>(that, arguments);
    <span class="ot">that</span>.<span class="fu">constructor</span> = <span class="kw">this</span>;
    <span class="kw">return</span> (<span class="kw">typeof</span> theOther === <span class="st">&#39;object&#39;</span> &amp;&amp; theOther) || that;
};</code></pre>
<p>Calling the <code>create</code> method on a constructor function results in the exact same constellation of objects and their connections as if the constructor was invoked with <code>new</code>. So, while it technically does not matter, the <code>create</code> method makes for a less confusing reading of code.</p>
<h3 id="using-constructors">Using Constructors</h3>
<p>Instead of classes, we define functions, that can be used, as constructors:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> Movie = <span class="kw">function</span> (title, director) {
    <span class="kw">this</span>.<span class="fu">title</span> = title;
    <span class="kw">this</span>.<span class="fu">director</span> = director;
};
<span class="kw">var</span> pulpFiction = <span class="ot">Movie</span>.<span class="fu">create</span>(<span class="st">&#39;Pulp Fiction&#39;</span>, <span class="st">&#39;Quentin Tarantino&#39;</span>);</code></pre>
<p>The constructor function takes two arguments, that it attaches to <code>this</code>. In <a href="#04.02.03">04.02.03</a> we learned, that using the <code>new</code> keyword creates a new object, that is bound to the constructor’s <code>this</code>, and returns the new object.</p>
<p>Our new object is pretty useless as long as it does not have any methods. But just like we can add string properties to the new object, we can add methods to it:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> Movie = <span class="kw">function</span> (title, length) {
    <span class="kw">this</span>.<span class="fu">title</span> = title;
    <span class="kw">this</span>.<span class="fu">length</span> = length;
    <span class="kw">this</span>.<span class="fu">isLong</span> = <span class="kw">function</span> () {
        <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">length</span> &gt; <span class="dv">120</span>;
    };
};
<span class="kw">var</span> psycho = <span class="ot">Movie</span>.<span class="fu">create</span>(<span class="st">&#39;Psycho&#39;</span>, <span class="dv">109</span>);
<span class="ot">psycho</span>.<span class="fu">isLong</span>(); <span class="co">// false</span></code></pre>
<p>Adding methods seems easy. But the problem with the above is, that the function expression is evaluated, each time the constructor is executed. That means, that there will be multiple instances of the same function in memory. Because of the late binding of <code>this</code>, that would not be necessary. <code>this</code> is bound, when the function executes, so we could use the function, without attaching it as a member to the object.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> isLong = <span class="kw">function</span> () {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">length</span> &gt; <span class="dv">120</span>;
};
<span class="ot">isLong</span>.<span class="fu">call</span>(psycho); <span class="co">// false</span></code></pre>
<p>But is this a better solution? It feels awkward to call a function like this and we also would like the function to have a closer syntactical relationship with the objects it is working with. We will look at two ways of using one function that is available to all <code>movie</code> objects.</p>
<h3 id="altering-the-prototype">Altering the prototype</h3>
<p>A common pattern is to attach methods to a constructor’s prototype.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> Movie = <span class="kw">function</span> (title, length) {
    <span class="kw">this</span>.<span class="fu">title</span> = title;
    <span class="kw">this</span>.<span class="fu">length</span> = length;
};
<span class="ot">Movie</span>.<span class="ot">prototype</span>.<span class="fu">isLong</span> = <span class="kw">function</span> () {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">length</span> &gt; <span class="dv">120</span>;
};
<span class="kw">var</span> pulpFiction = <span class="ot">Movie</span>.<span class="fu">create</span>(<span class="st">&#39;Pulp Fiction&#39;</span>, <span class="dv">154</span>);
<span class="ot">pulpFiction</span>.<span class="fu">isLong</span>(); <span class="co">// true</span></code></pre>
<p>A method, defined this way, behaves like a public static method in Java. It is accessible to every instance, created by the <code>Movie</code> constructor, and is visible to the outside. The difference is, that static methods in Java have no access to instance variables like <code>this</code>, whereas in JavaScript, they have (again, because of the late binding of <code>this</code>). This feature is essential to building constructors and objects in JavaScript.</p>
<p>Another one of those essential features will help us complement the public static method with a pattern for writing private static methods as well as private instance variables.</p>
<h3 id="using-closure">Using closure</h3>
<p>The second way of exposing a method to every object with a given constructor, without creating multiple function objects for that method, uses one of the most powerful features of JavaScript: Closure. Using closures with constructors will be our topic for almost every other pattern in this chapter. Since we just created a public static method, we can now create a private static method.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> Movie = (<span class="kw">function</span> () {
    <span class="kw">var</span> isLong = <span class="kw">function</span> () { <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">length</span> &gt; <span class="dv">120</span>; };
    <span class="kw">return</span> <span class="kw">function</span> (title, length) {
        <span class="kw">this</span>.<span class="fu">title</span> = title;
        <span class="kw">this</span>.<span class="fu">length</span> = length;
        <span class="ot">console</span>.<span class="fu">log</span>(<span class="kw">this</span>.<span class="fu">title</span> + <span class="st">&#39; is&#39;</span> + (<span class="ot">isLong</span>.<span class="fu">call</span>(<span class="kw">this</span>) ? <span class="st">&#39;&#39;</span> : <span class="st">&#39; not&#39;</span>) + <span class="st">&#39; a long movie.&#39;</span>);
    };
}());</code></pre>
<p>Again, “static” means, that it is shared by all instances of that “class”, but that it can have access to instance variables.</p>
<h3 id="private-variables">Private Variables</h3>
<p>The most important use for closures in constructors is for creating private instance variables.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> Movie = <span class="kw">function</span> (title, length) {
    <span class="kw">this</span>.<span class="fu">title</span> = title;
    <span class="kw">this</span>.<span class="fu">isLong</span> = <span class="kw">function</span> () { <span class="kw">return</span> length &gt; <span class="dv">120</span>; };
};
<span class="kw">var</span> memento = <span class="ot">Movie</span>.<span class="fu">create</span>(<span class="st">&#39;Memento&#39;</span>, <span class="dv">113</span>);
<span class="ot">memento</span>.<span class="fu">isLong</span>(); <span class="co">// false</span></code></pre>
<p>The <code>length</code> variable is accessible inside the constructor function even when it has returned. But the variable is not added as a member to this or any object and is thus not visible from the outside. The <code>isLong</code> function can use the <code>length</code> variable because of closure and everytime, you call that method, it gives you the correct result. The scope, in which length exists, lives on, but is unnaccessible from code outside of the constructor.</p>
<p>Some people attach variables they consider private to the object and prefix their name with an underscore to indicate that it is a private variable. It does not really make sense to use privacy by convention when there is also privacy by technology. When you see variables, starting with underscores, in someone else’s code, respect their proclamation of privacy for these variables, but do not rely on it in your own code - use closure instead.</p>
<h2 id="bonus-y-combinator">BONUS: y-Combinator</h2>[...]
</body>
</html>